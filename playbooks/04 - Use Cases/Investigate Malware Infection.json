{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Investigate Malware Infection",
    "aliasName": null,
    "tag": null,
    "description": "Investigates a malware infection by querying ElasticSearch and Active Directory.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1637679100,
    "collection": "\/api\/3\/workflow_collections\/59667fcc-7feb-4ba4-a5a2-e03a9287f857",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/94c5bfe3-90c3-4b71-b5e7-023b4aca650a",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Mark Alert as Closed False Positive",
            "description": "Update Alert status to Closed(False Positive)",
            "arguments": {
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Marked Alert status as&nbsp;<span style=\"background:#107d31; color:#fff;\" class=\"badge badge-pill badge-danger\"><strong>Closed (False Positive)<\/strong><\/span><\/p>",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 246,
                        "@id": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Closed",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Closed",
                        "orderIndex": 4
                    },
                    "closureReason": {
                        "id": 250,
                        "@id": "\/api\/3\/picklists\/2b0112f6-4746-4dab-ada6-a8cd1e675572",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "False Positive",
                        "listName": "\/api\/3\/picklist_names\/4ebacea1-88cd-4ea8-9dcc-385bea42cc59",
                        "itemValue": "False Positive",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1520",
            "left": "480",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "20cb1b9f-a785-4081-8ab1-b1973bfba405",
            "id": 3345
        },
        {
            "@type": "WorkflowStep",
            "name": "Fetch Active Affected Host List",
            "description": "Fetch list of Host Affected during infection period",
            "arguments": {
                "name": "ElasticSearch",
                "config": "bcc454f7-9fa7-47ca-8359-3e9c2c481940",
                "params": {
                    "index": "winlogbeat.*",
                    "query": "{   \"_source\": [     \"host\"   ],   \"query\": {     \"filtered\": {       \"filter\": {         \"range\": {           \"@timestamp\": {             \"gte\": \"{{arrow.get(vars.alertMetaData._source['@timestamp']).format('YYYY-MM-DD HH:mm:ss')}}\",             \"lt\": \"{{arrow.utcnow().format('YYYY-MM-DD HH:mm:ss')}}\"           }         }       },       \"query\": {         \"match\": {           \"message\": {             \"query\": \"f58857118b78a4a9dd337fe5bb2d6857\"           }         }       }     }   },   \"size\": 50 }",
                    "routing": "",
                    "doc_type": "",
                    "run_as_user": ""
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Queried SIEM and found suspected process was active on the following hosts:<\/p>\n<p>&nbsp;<\/p>\n<table width=\"225\" border=\"2\" style=\"height: 43px;\">\n<tbody>\n<tr>\n<th style=\"width: 260px;\">Host name<\/th>\n<th style=\"width: 259px;\">IP<\/th>\n<\/tr>\n<tr style=\"display: none;\">\n<td style=\"width: auto;\">{% for items in vars.result.data.hits.hits %}<\/td>\n<td style=\"width: auto;\">{% if items._source.host.name != vars.input.records[0].targetAsset %}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 260px;\">{{items._source.host.name}}<\/td>\n<td style=\"width: 259px;\">{{items._source.host.ip[1]}}<\/td>\n<\/tr>\n<tr style=\"display: none;\">\n<td style=\"width: auto;\">{%endif%}<\/td>\n<td style=\"width: auto;\">{% endfor %}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>",
                    "records": ""
                },
                "version": "2.2.1",
                "connector": "elasticsearch",
                "operation": "execute_query",
                "mock_result": "{\n  \"data\": {\n    \"hits\": {\n      \"hits\": [\n        {\n          \"_id\": \"qvEI4WsB_gheKj_-35NM\",\n          \"_type\": \"doc\",\n          \"_index\": \"winlogbeat-7.2.0-2019.07.11\",\n          \"_score\": 7.986301,\n          \"_source\": {\n            \"log\": {\n              \"level\": \"error\"\n            },\n            \"host\": {\n              \"id\": \"2ebed189-e68e-449b-af86-66a951598lkq\",\n              \"ip\": [\n                \"fe80::11ee:700f:2475:1181\",\n                \"192.168.60.159\",\n                \"fe80::1cb2:4baf:cd1d:9b1\"\n              ],\n              \"os\": {\n                \"name\": \"Windows 7\",\n                \"build\": \"15299.431\",\n                \"family\": \"windows\",\n                \"kernel\": \"10.0.15299.431 (WinBuild.140101.0800)\",\n                \"version\": \"7.0\",\n                \"platform\": \"windows\"\n              },\n              \"geo\": {\n                \"name\": \"nyc-dc1-rack2\",\n                \"location\": \"41.7128, -74.0060\",\n                \"city_name\": \"New York\",\n                \"region_name\": \"New York\",\n                \"continent_name\": \"North America\",\n                \"region_iso_code\": \"NY\",\n                \"country_iso_code\": \"US\"\n              },\n              \"mac\": [\n                \"00:50:56:67:f0:f8\",\n                \"00:00:00:00:00:00:00:f0\"\n              ],\n              \"name\": \"DESKTOP-CyberOp1\",\n              \"hostname\": \"DESKTOP-CyberOp1\",\n              \"architecture\": \"x86_64\"\n            },\n            \"agent\": {\n              \"id\": \"57e71f45-0d82-4065-8f33-3f342cccf5a8\",\n              \"type\": \"winlogbeat\",\n              \"version\": \"7.2.0\",\n              \"hostname\": \"DESKTOP-CyberOp1\",\n              \"ephemeral_id\": \"525874bc-e728-48e4-a086-0e5c51ee3126\"\n            },\n            \"event\": {\n              \"code\": 8427\n            },\n            \"message\": \"Found filehash f58857118b78a4a9dd337fe5bb2d6857\",\n            \"@timestamp\": \"{{arrow.get(vars.alertMetaData._source['@timestamp']).replace(minutes=+2.12).format('YYYY-MM-DDTHH:mm:ss')}}.{{range(1, 999) | random}}Z\"\n          }\n        },\n        {\n          \"_id\": \"23dI4WsB_gheKj_-kj58\",\n          \"_type\": \"doc\",\n          \"_index\": \"winlogbeat-7.2.0-2019.07.11\",\n          \"_score\": 5.982501,\n          \"_source\": {\n            \"log\": {\n              \"level\": \"error\"\n            },\n            \"host\": {\n              \"id\": \"6abed189-e68e-449b-af86-66a95178afq\",\n              \"ip\": [\n                \"ae90::11ee:700f:2475:5891\",\n                \"192.168.50.128\",\n                \"ce80::1cb2:4baf:cd1d:a91\"\n              ],\n              \"os\": {\n                \"name\": \"Windows 10\",\n                \"build\": \"16299.431\",\n                \"family\": \"windows\",\n                \"kernel\": \"10.0.16299.431 (WinBuild.160101.0800)\",\n                \"version\": \"10.0\",\n                \"platform\": \"windows\"\n              },\n              \"geo\": {\n                \"name\": \"nyjc-dc1-rack2\",\n                \"location\": \"39.845, -74.0860\",\n                \"city_name\": \"New Jersey\",\n                \"region_name\": \"New Jersey\",\n                \"continent_name\": \"North America\",\n                \"region_iso_code\": \"NJ\",\n                \"country_iso_code\": \"US\"\n              },\n              \"mac\": [\n                \"00:50:56:6e:ab:de\",\n                \"00:00:00:00:00:00:00:b9\"\n              ],\n              \"name\": \"DESKTOP-CyberOp3\",\n              \"hostname\": \"DESKTOP-CyberOp3\",\n              \"architecture\": \"x86_64\"\n            },\n            \"agent\": {\n              \"id\": \"57e71f45-0d82-4065-8f33-3f342c67afb8\",\n              \"type\": \"winlogbeat\",\n              \"version\": \"7.2.0\",\n              \"hostname\": \"DESKTOP-CyberOp3\",\n              \"ephemeral_id\": \"525874bc-e728-48e4-a086-0e5c51ee3126\"\n            },\n            \"event\": {\n              \"code\": 8628\n            },\n            \"message\": \"Found filehash f58857118b78a4a9dd337fe5bb2d6857\",\n            \"@timestamp\": \"{{arrow.get(vars.alertMetaData._source['@timestamp']).replace(minutes=+3.24).format('YYYY-MM-DDTHH:mm:ss')}}.{{range(1, 999) | random}}Z\"\n          }\n        },\n        {\n          \"_id\": \"PPEK4WsB_gheKj_-jZ8R\",\n          \"_type\": \"doc\",\n          \"_index\": \"winlogbeat-7.2.0-2019.07.11\",\n          \"_score\": 6.986522,\n          \"_source\": {\n            \"log\": {\n              \"level\": \"error\"\n            },\n            \"host\": {\n              \"id\": \"2ebed189-e68e-449b-af86-66a951507c3a\",\n              \"ip\": [\n                \"fe80::11ee:700f:2475:1080\",\n                \"192.168.60.158\",\n                \"fe80::ffff:ffff:fffe\"\n              ],\n              \"os\": {\n                \"name\": \"Windows 10 Pro\",\n                \"build\": \"16299.431\",\n                \"family\": \"windows\",\n                \"kernel\": \"10.0.16299.431 (WinBuild.160101.0800)\",\n                \"version\": \"10.0\",\n                \"platform\": \"windows\"\n              },\n              \"geo\": {\n                \"name\": \"nyc-dc1-rack1\",\n                \"location\": \"40.7128, -74.0060\",\n                \"city_name\": \"New York\",\n                \"region_name\": \"New York\",\n                \"continent_name\": \"North America\",\n                \"region_iso_code\": \"NY\",\n                \"country_iso_code\": \"US\"\n              },\n              \"mac\": [\n                \"00:50:56:87:a0:f8\",\n                \"00:00:00:00:00:00:00:e0\"\n              ],\n              \"name\": \"DESKTOP-GLAQVLV\",\n              \"hostname\": \"DESKTOP-GLAQVLV\",\n              \"architecture\": \"x86_64\"\n            },\n            \"agent\": {\n              \"id\": \"57e71f45-0d82-4065-8f33-3f342cccf5a8\",\n              \"type\": \"winlogbeat\",\n              \"version\": \"7.2.0\",\n              \"hostname\": \"DESKTOP-GLAQVLV\",\n              \"ephemeral_id\": \"0f474cc3-c01e-40cd-8ec9-80ff7bc479ad\"\n            },\n            \"event\": {\n              \"code\": 8428\n            },\n            \"message\": \"Found filehash f58857118b78a4a9dd337fe5bb2d6857\",\n            \"@timestamp\": \"{{vars.alertMetaData._source['@timestamp']}}\"\n          }\n        }\n      ],\n      \"total\": 3,\n      \"max_score\": 8.945301\n    },\n    \"took\": 3.5,\n    \"_shards\": {\n      \"total\": 52,\n      \"failed\": 0,\n      \"skipped\": 0,\n      \"successful\": 52\n    },\n    \"timed_out\": false\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null\n}",
                "operationTitle": "Execute Query",
                "step_variables": []
            },
            "status": null,
            "top": "560",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "44d71b8a-dd4f-4d5e-b37e-f4bb29e79f2d",
            "id": 3346
        },
        {
            "@type": "WorkflowStep",
            "name": "Create note for manual intervention",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Awaiting response for user input on VM snapshot..<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "980",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "20790c61-9a17-47c5-b80d-d8949c86699a",
            "id": 3347
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "f10d0ae2-1050-4632-b7eb-5a0b4140f518",
                "title": "Investigate Malware Infection",
                "resources": [
                    "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "records": "{{vars.input.records}}"
                    }
                },
                "_promptexpanded": true,
                "displayConditions": {
                    "alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": [
                            {
                                "type": "object",
                                "field": "type",
                                "value": "\/api\/3\/picklists\/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                                "_value": {
                                    "itemValue": "Malware"
                                },
                                "operator": "eq"
                            },
                            {
                                "type": "object",
                                "field": "status",
                                "value": "\/api\/3\/picklists\/7de816ff-7140-4ee5-bd05-93ce22002146",
                                "_value": {
                                    "itemValue": "Open"
                                },
                                "operator": "eq"
                            },
                            {
                                "type": "primitive",
                                "field": "source",
                                "value": "ElasticSearch",
                                "operator": "eq"
                            }
                        ]
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "uuid": "94c5bfe3-90c3-4b71-b5e7-023b4aca650a",
            "id": 3348
        },
        {
            "@type": "WorkflowStep",
            "name": "Fetch list of affected host",
            "description": null,
            "arguments": {
                "name": "ElasticSearch",
                "config": "bcc454f7-9fa7-47ca-8359-3e9c2c481940",
                "params": {
                    "index": "winlogbeat*",
                    "query": "{   \"_source\": [     \"message\",     \"agent.hostname\",     \"host\",     \"@timestamp\",     \"event.code\",     \"log.level\",     \"_id\"   ],   \"query\": {     \"match\": {       \"message\": {         \"query\": \"{{vars.input.records[0].filehash}}\"       }     }   },   \"size\": 50 }",
                    "routing": "",
                    "doc_type": "",
                    "run_as_user": ""
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Queried SIEM and found following additional hosts having same process present on them:<\/p>\n<p>&nbsp;<\/p>\n<table width=\"225\" border=\"2\" style=\"height: 43px;\">\n<tbody>\n<tr>\n<th style=\"width: 260px;\">Host name<\/th>\n<th style=\"width: 259px;\">IP<\/th>\n<\/tr>\n<tr style=\"display: none;\">\n<td style=\"width: auto;\">{% for items in vars.result.data.hits.hits %}<\/td>\n<td style=\"width: auto;\">{% if items._source.host.name != vars.input.records[0].targetAsset %}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 260px;\">{{items._source.host.name}}<\/td>\n<td style=\"width: 259px;\">{{items._source.host.ip[1]}}<\/td>\n<\/tr>\n<tr style=\"display: none;\">\n<td style=\"width: auto;\">{%endif%}<\/td>\n<td style=\"width: auto;\">{% endfor %}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>",
                    "records": ""
                },
                "version": "2.2.1",
                "connector": "elasticsearch",
                "operation": "execute_query",
                "mock_result": "{\n  \"data\": {\n    \"hits\": {\n      \"hits\": [\n        {\n          \"_id\": \"qvEI4WsB_gheKj_-35NM\",\n          \"_type\": \"doc\",\n          \"_index\": \"winlogbeat-7.2.0-2019.07.11\",\n          \"_score\": 7.986301,\n          \"_source\": {\n            \"log\": {\n              \"level\": \"error\"\n            },\n            \"host\": {\n              \"id\": \"2ebed189-e68e-449b-af86-66a951598lkq\",\n              \"ip\": [\n                \"fe80::11ee:700f:2475:1181\",\n                \"192.168.60.159\",\n                \"fe80::1cb2:4baf:cd1d:9b1\"\n              ],\n              \"os\": {\n                \"name\": \"Windows 7\",\n                \"build\": \"15299.431\",\n                \"family\": \"windows\",\n                \"kernel\": \"10.0.15299.431 (WinBuild.140101.0800)\",\n                \"version\": \"7.0\",\n                \"platform\": \"windows\"\n              },\n              \"geo\": {\n                \"name\": \"nyc-dc1-rack2\",\n                \"location\": \"41.7128, -74.0060\",\n                \"city_name\": \"New York\",\n                \"region_name\": \"New York\",\n                \"continent_name\": \"North America\",\n                \"region_iso_code\": \"NY\",\n                \"country_iso_code\": \"US\"\n              },\n              \"mac\": [\n                \"00:50:56:67:f0:f8\",\n                \"00:00:00:00:00:00:00:f0\"\n              ],\n              \"name\": \"DESKTOP-CyberOp1\",\n              \"hostname\": \"DESKTOP-CyberOp1\",\n              \"architecture\": \"x86_64\"\n            },\n            \"agent\": {\n              \"id\": \"57e71f45-0d82-4065-8f33-3f342cccf5a8\",\n              \"type\": \"winlogbeat\",\n              \"version\": \"7.2.0\",\n              \"hostname\": \"DESKTOP-CyberOp1\",\n              \"ephemeral_id\": \"525874bc-e728-48e4-a086-0e5c51ee3126\"\n            },\n            \"event\": {\n              \"code\": 8427\n            },\n            \"message\": \"Found filehash f58857118b78a4a9dd337fe5bb2d6857\",\n            \"@timestamp\": \"{{arrow.get(vars.alertMetaData._source['@timestamp']).replace(minutes=+2.12).format('YYYY-MM-DDTHH:mm:ss')}}.{{range(1, 999) | random}}Z\"\n          }\n        },\n        {\n          \"_id\": \"abnI4WsB_gheKj_-3569\",\n          \"_type\": \"doc\",\n          \"_index\": \"winlogbeat-7.2.0-2019.07.11\",\n          \"_score\": 8.945301,\n          \"_source\": {\n            \"log\": {\n              \"level\": \"error\"\n            },\n            \"host\": {\n              \"id\": \"2ebed189-e68e-449b-af86-66a951598lkq\",\n              \"ip\": [\n                \"fe80::11ee:700f:3485:fa12\",\n                \"10.52.68.2\",\n                \"fe80::1cb2:4baf:cd1d:ab65\"\n              ],\n              \"os\": {\n                \"name\": \"Windows 8\",\n                \"build\": \"15485.452\",\n                \"family\": \"windows\",\n                \"kernel\": \"10.0.15299.431 (WinBuild.142101.0880)\",\n                \"version\": \"8.0\",\n                \"platform\": \"windows\"\n              },\n              \"geo\": {\n                \"name\": \"nyc-dc1-rack2\",\n                \"location\": \"43.7128, -74.0060\",\n                \"city_name\": \"New York\",\n                \"region_name\": \"New York\",\n                \"continent_name\": \"North America\",\n                \"region_iso_code\": \"NY\",\n                \"country_iso_code\": \"US\"\n              },\n              \"mac\": [\n                \"00:50:56:b7:a0:e8\",\n                \"00:00:00:00:00:00:00:a0\"\n              ],\n              \"name\": \"DESKTOP-CyberOp2\",\n              \"hostname\": \"DESKTOP-CyberOp2\",\n              \"architecture\": \"x86_64\"\n            },\n            \"agent\": {\n              \"id\": \"58a71f45-0d82-4065-8f33-3f342cabf523\",\n              \"type\": \"winlogbeat\",\n              \"version\": \"7.2.0\",\n              \"hostname\": \"DESKTOP-CyberOp2\",\n              \"ephemeral_id\": \"a34874bc-e728-48e4-a086-0e5c51ee3ffa\"\n            },\n            \"event\": {\n              \"code\": 8952\n            },\n            \"message\": \"Found filehash f58857118b78a4a9dd337fe5bb2d6857\",\n            \"@timestamp\": \"{{arrow.get(vars.alertMetaData._source['@timestamp']).replace(minutes=-4.13).format('YYYY-MM-DDTHH:mm:ss')}}.{{range(1, 999) | random}}Z\"\n          }\n        },\n        {\n          \"_id\": \"23dI4WsB_gheKj_-kj58\",\n          \"_type\": \"doc\",\n          \"_index\": \"winlogbeat-7.2.0-2019.07.11\",\n          \"_score\": 5.982501,\n          \"_source\": {\n            \"log\": {\n              \"level\": \"error\"\n            },\n            \"host\": {\n              \"id\": \"6abed189-e68e-449b-af86-66a95178afq\",\n              \"ip\": [\n                \"ae90::11ee:700f:2475:5891\",\n                \"192.168.50.128\",\n                \"ce80::1cb2:4baf:cd1d:a91\"\n              ],\n              \"os\": {\n                \"name\": \"Windows 10\",\n                \"build\": \"16299.431\",\n                \"family\": \"windows\",\n                \"kernel\": \"10.0.16299.431 (WinBuild.160101.0800)\",\n                \"version\": \"10.0\",\n                \"platform\": \"windows\"\n              },\n              \"geo\": {\n                \"name\": \"nyjc-dc1-rack2\",\n                \"location\": \"39.845, -74.0860\",\n                \"city_name\": \"New Jersey\",\n                \"region_name\": \"New Jersey\",\n                \"continent_name\": \"North America\",\n                \"region_iso_code\": \"NJ\",\n                \"country_iso_code\": \"US\"\n              },\n              \"mac\": [\n                \"00:50:56:6e:ab:de\",\n                \"00:00:00:00:00:00:00:b9\"\n              ],\n              \"name\": \"DESKTOP-CyberOp3\",\n              \"hostname\": \"DESKTOP-CyberOp3\",\n              \"architecture\": \"x86_64\"\n            },\n            \"agent\": {\n              \"id\": \"57e71f45-0d82-4065-8f33-3f342c67afb8\",\n              \"type\": \"winlogbeat\",\n              \"version\": \"7.2.0\",\n              \"hostname\": \"DESKTOP-CyberOp3\",\n              \"ephemeral_id\": \"525874bc-e728-48e4-a086-0e5c51ee3126\"\n            },\n            \"event\": {\n              \"code\": 8628\n            },\n            \"message\": \"Found filehash f58857118b78a4a9dd337fe5bb2d6857\",\n            \"@timestamp\": \"{{arrow.get(vars.alertMetaData._source['@timestamp']).replace(minutes=+3.24).format('YYYY-MM-DDTHH:mm:ss')}}.{{range(1, 999) | random}}Z\"\n          }\n        },\n        {\n          \"_id\": \"PPEK4WsB_gheKj_-jZ8R\",\n          \"_type\": \"doc\",\n          \"_index\": \"winlogbeat-7.2.0-2019.07.11\",\n          \"_score\": 6.986522,\n          \"_source\": {\n            \"log\": {\n              \"level\": \"error\"\n            },\n            \"host\": {\n              \"id\": \"2ebed189-e68e-449b-af86-66a951507c3a\",\n              \"ip\": [\n                \"fe80::11ee:700f:2475:1080\",\n                \"192.168.60.158\",\n                \"fe80::ffff:ffff:fffe\"\n              ],\n              \"os\": {\n                \"name\": \"Windows 10 Pro\",\n                \"build\": \"16299.431\",\n                \"family\": \"windows\",\n                \"kernel\": \"10.0.16299.431 (WinBuild.160101.0800)\",\n                \"version\": \"10.0\",\n                \"platform\": \"windows\"\n              },\n              \"geo\": {\n                \"name\": \"nyc-dc1-rack1\",\n                \"location\": \"40.7128, -74.0060\",\n                \"city_name\": \"New York\",\n                \"region_name\": \"New York\",\n                \"continent_name\": \"North America\",\n                \"region_iso_code\": \"NY\",\n                \"country_iso_code\": \"US\"\n              },\n              \"mac\": [\n                \"00:50:56:87:a0:f8\",\n                \"00:00:00:00:00:00:00:e0\"\n              ],\n              \"name\": \"DESKTOP-GLAQVLV\",\n              \"hostname\": \"DESKTOP-GLAQVLV\",\n              \"architecture\": \"x86_64\"\n            },\n            \"agent\": {\n              \"id\": \"57e71f45-0d82-4065-8f33-3f342cccf5a8\",\n              \"type\": \"winlogbeat\",\n              \"version\": \"7.2.0\",\n              \"hostname\": \"DESKTOP-GLAQVLV\",\n              \"ephemeral_id\": \"0f474cc3-c01e-40cd-8ec9-80ff7bc479ad\"\n            },\n            \"event\": {\n              \"code\": 8428\n            },\n            \"message\": \"Found filehash f58857118b78a4a9dd337fe5bb2d6857\",\n            \"@timestamp\": \"{{vars.alertMetaData._source['@timestamp']}}\"\n          }\n        }\n      ],\n      \"total\": 4,\n      \"max_score\": 8.945301\n    },\n    \"took\": 3.5,\n    \"_shards\": {\n      \"total\": 52,\n      \"failed\": 0,\n      \"skipped\": 0,\n      \"successful\": 52\n    },\n    \"timed_out\": false\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null\n}",
                "operationTitle": "Execute Query",
                "step_variables": {
                    "affectedHost": "{{vars.result.data.hits.hits | json_query(\"[?_source.host.name!='DESKTOP-GLAQVLV']._source.host\")}}"
                }
            },
            "status": null,
            "top": "435",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "3668e465-1fed-44b4-aef3-56bfe4fc1f1b",
            "id": 3349
        },
        {
            "@type": "WorkflowStep",
            "name": "Start Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Investigating Potential {{vars.input.records[0].type.itemValue}}, with following fields of interest:\nImpacted Asset:{{vars.input.records[0].targetAsset}}\nImpacted since: {{arrow.get(vars.alertMetaData._source['@timestamp']).format('YYYY-MM-DD HH:mm:ss')}\n{% if vars.input.records[0].domain %}Domain: {{vars.input.records[0].domain -}}{% endif %}\n{% if vars.input.records[0].sourceIp %}SourceIP: {{ vars.input.records[0].sourceIp -}}{% endif %}\n{% if vars.input.records[0].destinationIp %}DestinationIP: {{vars.input.records[0].destinationIp -}}{% endif %}\n{% if vars.input.records[0].fileHash %}File Hash: {{vars.input.records[0].fileHash -}}{% endif %}\n{% if vars.input.records[0].computerName %}ComputerName: {{vars.input.records[0].computerName -}}{% endif %}\n{% if vars.input.records[0].processName %}Process: {{vars.input.records[0].processName -}}{% endif %}\n{% if vars.input.records[0].sourceProcess %}SourceProcess: {{vars.input.records[0].sourceProcess -}}{% endif %}",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 113,
                        "@id": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Investigating",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Investigating",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "f386de85-8210-4c76-bd61-f34ed6cf25e4",
            "id": 3350
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Status of Alert",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Close Alert",
                        "description": "<p>Specify reason for closing the Alert<\/p>",
                        "inputVariables": [
                            {
                                "name": "closureNotes",
                                "type": "string",
                                "label": "Closure Notes",
                                "title": "Rich Text",
                                "usable": true,
                                "tooltip": "",
                                "dataType": "text",
                                "formType": "richtext",
                                "required": true,
                                "_expanded": true,
                                "collection": false,
                                "searchable": true,
                                "templateUrl": "app\/components\/form\/fields\/richtext.html",
                                "defaultValue": null,
                                "allowedEncryption": true,
                                "allowedGridColumn": true,
                                "useRecordFieldDefault": false
                            }
                        ]
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "owner_detail": {
                    "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Close",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/39ecbdf9-8fd2-485c-88e4-01312c8eeddf"
                        },
                        {
                            "option": "Close (False Positive)",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/20cb1b9f-a785-4081-8ab1-b1973bfba405"
                        }
                    ],
                    "duplicateOption": false
                }
            },
            "status": null,
            "top": "1380",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "uuid": "a0386efa-524c-4f66-8f6e-db24e3130887",
            "id": 3351
        },
        {
            "@type": "WorkflowStep",
            "name": "Take snapshot of machine",
            "description": null,
            "arguments": {
                "name": "VMware vSphere",
                "config": "8144b567-1f25-4fe1-8b24-89c06ac70e94",
                "params": {
                    "memory": false,
                    "quiesce": false,
                    "vm_name": "{{vars.input.records[0].targetAsset}}",
                    "description": "Taking virtual machine snapshot",
                    "snapshot_name": "Snapshot-{{arrow.utcnow().format('YYYY-MM-DDTHH:mm:ss')}}"
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>{% if vars.result.data.status == \"Success\" %}Initiated VM snapshot process{%else%}Unable to take snapshot{%endif%}<\/p>",
                    "records": ""
                },
                "version": "1.0.1",
                "connector": "vmware-vsphere",
                "operation": "snapshot_vm",
                "mock_result": "{\n  \"data\": {\n    \"status\": \"Success\",\n    \"result\": \"Virtual machine {{vars.input.records[0].targetAsset}} snapshot taken sucsessfully\"\n  }\n}",
                "operationTitle": "Snapshot VM",
                "step_variables": []
            },
            "status": null,
            "top": "1240",
            "left": "120",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "d72fd909-1785-4e0b-a1a8-bf0691643f2f",
            "id": 3352
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "alertMetaData": "{{vars.input.records[0].sourceData}}",
                "useMockOutput": "true"
            },
            "status": null,
            "top": "165",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "2c4f515a-31ef-4ff7-8efd-5c325d834258",
            "id": 3353
        },
        {
            "@type": "WorkflowStep",
            "name": "is VM snapshot required",
            "description": null,
            "arguments": {
                "type": "DecisionBased",
                "input": {
                    "schema": {
                        "title": "VM snapshot",
                        "description": "<p>Is the snapshot of the VM required?<\/p>",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "owner_detail": {
                    "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Yes",
                            "step_iri": "\/api\/3\/workflow_steps\/d72fd909-1785-4e0b-a1a8-bf0691643f2f"
                        },
                        {
                            "option": "No",
                            "step_iri": "\/api\/3\/workflow_steps\/88e0635f-d77e-4d52-9579-5f2b2e864764"
                        }
                    ],
                    "duplicateOption": false
                }
            },
            "status": null,
            "top": "1100",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "uuid": "c7548dd9-1a9c-4e00-963c-ccb2f542b448",
            "id": 3354
        },
        {
            "@type": "WorkflowStep",
            "name": "Fetch active user session on affected host",
            "description": "Fetch active user session on affected host",
            "arguments": {
                "name": "Active Directory",
                "config": "cfc71036-0962-455a-8714-e00f0b0388d3",
                "params": {
                    "query": "(&(objectCategory=person)(objectClass=user)(lastLogon<={{arrow.get(vars.alertMetaData._source['@timestamp'])}}))",
                    "cookie": "",
                    "page_size": "",
                    "size_limit": ""
                },
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>List of active user on the host \"{{vars.input.records[0].targetAsset}}\" during infection period:<\/p>\n<p>&nbsp;<\/p>\n<table border=\"2\" style=\"width: 200px; height: 40px;\">\n<tbody>\n<tr>\n<th style=\"width: 60px;\">User Name<\/th>\n<th style=\"width: 100px;\">Login Time<\/th>\n<\/tr>\n<tr style=\"display: none;\">\n<td style=\"width: 121px;\">{% for items in vars.result.users %}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 60px;\">{{items.displayName}}<\/td>\n<td style=\"width: 100px;\">{{arrow.get(items.lastLogon).format('YYYY-MM-DD HH:mm:ss')}}<\/td>\n<\/tr>\n<tr style=\"display: none;\">\n<td style=\"width: 121px;\">{% endfor %}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>",
                    "records": ""
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "advanced_search",
                "mock_result": "{\n  \"users\": [\n    {\n      \"displayName\": \"mary.kom\",\n      \"lastLogon\": \"{{arrow.utcnow().replace(minutes=-17)}}\"\n    },\n    {\n      \"displayName\": \"john.larry\",\n      \"lastLogon\": \"{{arrow.utcnow().replace(minutes=-13)}}\"\n    }\n  ]\n}",
                "operationTitle": "Advanced Search",
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "cec507cd-783e-45f7-bb90-7710e89b73f5",
            "id": 3355
        },
        {
            "@type": "WorkflowStep",
            "name": "Mark Alert as Closed",
            "description": "Update Alert status to Closed",
            "arguments": {
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Marked Alert status as  <span style=\"background:#107d31; color:#fff;\" class=\"badge badge-pill badge-danger\"><strong>Closed<\/strong><\/span><\/p>",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 6802,
                        "@id": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Closed",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Closed",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1520",
            "left": "120",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "39ecbdf9-8fd2-485c-88e4-01312c8eeddf",
            "id": 3356
        },
        {
            "@type": "WorkflowStep",
            "name": "Find Malicious Indicators",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "object",
                            "field": "reputation",
                            "value": "\/api\/3\/picklists\/7074e547-7785-4979-be32-c6d0c863e4bd",
                            "_value": {
                                "@id": "\/api\/3\/picklists\/7074e547-7785-4979-be32-c6d0c863e4bd",
                                "itemValue": "Malicious"
                            },
                            "operator": "eq"
                        },
                        {
                            "type": "primitive",
                            "field": "alerts.id",
                            "value": "{{vars.input.records[0].id}}",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ]
                },
                "module": "indicators?$limit=30",
                "message": {
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>{% if vars.result | length == 0 %}<strong><span style=\"background:#339966; color: #fff;\" class=\"badge badge-pill badge-danger\">No Malicious Indicator found<\/span><\/strong><\/p>\n<p>{% else %}<strong><span style=\"background:#e31b1d; color: #fff;\" class=\"badge badge-pill badge-danger\">Malicious Indicator(s) found<\/span><\/strong>:<\/p>\n<p>&nbsp;<\/p>\n<table border=\"2\" style=\"height: 45px; width: 350px;\">\n<tbody>\n<tr>\n<th style=\"width: 60px;\">Type<\/th>\n<th style=\"width: 250px;\">Value<\/th>\n<\/tr>\n<tr style=\"display: none;\">\n<td style=\"width: 10px;\">{% for items in vars.result %}<\/td>\n<\/tr>\n<tr>\n<td style=\"width: 60px;\">{{items.typeofindicator.itemValue}}<\/td>\n<td style=\"width: 250px;\">{{items.value}}<\/td>\n<\/tr>\n<tr style=\"display: none;\">\n<td style=\"width: 60px;\">{% endfor %}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>{% endif %}<\/p>",
                    "records": ""
                },
                "do_until": {
                    "delay": 5,
                    "retries": 3,
                    "condition": "{{vars.result | length > 0}}"
                },
                "checkboxFields": false,
                "step_variables": []
            },
            "status": null,
            "top": "840",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "uuid": "972ac0c7-0fe0-484c-a0ab-fffdd1c69e66",
            "id": 3357
        },
        {
            "@type": "WorkflowStep",
            "name": "No Operation",
            "description": null,
            "arguments": {
                "name": "Utilities",
                "params": [],
                "message": {
                    "content": "<p>No snapshot was taken.<\/p>",
                    "records": ""
                },
                "version": "2.6.0",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "1245",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "88e0635f-d77e-4d52-9579-5f2b2e864764",
            "id": 3358
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "is VM snapshot required -> No Operation",
            "targetStep": "\/api\/3\/workflow_steps\/88e0635f-d77e-4d52-9579-5f2b2e864764",
            "sourceStep": "\/api\/3\/workflow_steps\/c7548dd9-1a9c-4e00-963c-ccb2f542b448",
            "label": "No",
            "isExecuted": false,
            "uuid": "44532f21-0e68-442d-81ee-a50a721b97cd"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Start Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/f386de85-8210-4c76-bd61-f34ed6cf25e4",
            "sourceStep": "\/api\/3\/workflow_steps\/2c4f515a-31ef-4ff7-8efd-5c325d834258",
            "label": null,
            "isExecuted": false,
            "uuid": "089bfa0c-0d80-459a-b71e-5c4f1c48571e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Status of Alert -> Copy  of Update Alert status to Investigating",
            "targetStep": "\/api\/3\/workflow_steps\/39ecbdf9-8fd2-485c-88e4-01312c8eeddf",
            "sourceStep": "\/api\/3\/workflow_steps\/a0386efa-524c-4f66-8f6e-db24e3130887",
            "label": "Close",
            "isExecuted": false,
            "uuid": "cb0d55f2-81bb-4bf0-88b5-644a38255243"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Find Malicious Indicators -> Create note for manual intervention",
            "targetStep": "\/api\/3\/workflow_steps\/20790c61-9a17-47c5-b80d-d8949c86699a",
            "sourceStep": "\/api\/3\/workflow_steps\/972ac0c7-0fe0-484c-a0ab-fffdd1c69e66",
            "label": null,
            "isExecuted": false,
            "uuid": "714b90e5-4678-45a7-8d65-0c766c6cdd52"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/2c4f515a-31ef-4ff7-8efd-5c325d834258",
            "sourceStep": "\/api\/3\/workflow_steps\/94c5bfe3-90c3-4b71-b5e7-023b4aca650a",
            "label": null,
            "isExecuted": false,
            "uuid": "0e52ce2a-174f-4450-a667-d3e0882f6c96"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fetch list of affected host -> Fetch Active Affected Host List",
            "targetStep": "\/api\/3\/workflow_steps\/44d71b8a-dd4f-4d5e-b37e-f4bb29e79f2d",
            "sourceStep": "\/api\/3\/workflow_steps\/3668e465-1fed-44b4-aef3-56bfe4fc1f1b",
            "label": null,
            "isExecuted": false,
            "uuid": "1b465365-5e26-42d4-a5ab-64fa3473ec70"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Status of Alert -> Copy  of Copy  of Update Alert status to Investigating",
            "targetStep": "\/api\/3\/workflow_steps\/20cb1b9f-a785-4081-8ab1-b1973bfba405",
            "sourceStep": "\/api\/3\/workflow_steps\/a0386efa-524c-4f66-8f6e-db24e3130887",
            "label": "Close (False Positive)",
            "isExecuted": false,
            "uuid": "4fd2ecab-7fd0-431c-8606-fd55afcda2ef"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Investigation -> Fetch list of affected host",
            "targetStep": "\/api\/3\/workflow_steps\/3668e465-1fed-44b4-aef3-56bfe4fc1f1b",
            "sourceStep": "\/api\/3\/workflow_steps\/f386de85-8210-4c76-bd61-f34ed6cf25e4",
            "label": null,
            "isExecuted": false,
            "uuid": "51afda95-a37b-4442-8f2a-f31bf62f8725"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fetch Active Affected Host List -> Fetch active user session on affected host",
            "targetStep": "\/api\/3\/workflow_steps\/cec507cd-783e-45f7-bb90-7710e89b73f5",
            "sourceStep": "\/api\/3\/workflow_steps\/44d71b8a-dd4f-4d5e-b37e-f4bb29e79f2d",
            "label": null,
            "isExecuted": false,
            "uuid": "1d18e7e6-c61e-4531-809c-ddb8c9bf66e1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Take snapshot of machine -> Update Status of Alert",
            "targetStep": "\/api\/3\/workflow_steps\/a0386efa-524c-4f66-8f6e-db24e3130887",
            "sourceStep": "\/api\/3\/workflow_steps\/d72fd909-1785-4e0b-a1a8-bf0691643f2f",
            "label": null,
            "isExecuted": false,
            "uuid": "3a440f56-faaf-4003-8d6a-2f3aa2d6aaf3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "No Operation -> Update Status of Alert",
            "targetStep": "\/api\/3\/workflow_steps\/a0386efa-524c-4f66-8f6e-db24e3130887",
            "sourceStep": "\/api\/3\/workflow_steps\/88e0635f-d77e-4d52-9579-5f2b2e864764",
            "label": null,
            "isExecuted": false,
            "uuid": "74508211-5abc-4101-a2f6-edb2126de0b0"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fetch active user session on affected host -> Find Malicious Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/972ac0c7-0fe0-484c-a0ab-fffdd1c69e66",
            "sourceStep": "\/api\/3\/workflow_steps\/cec507cd-783e-45f7-bb90-7710e89b73f5",
            "label": null,
            "isExecuted": false,
            "uuid": "0e66e19c-cd68-4b6e-a095-ecaf838e91a9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create note for manual intervention -> is VM snapshot required",
            "targetStep": "\/api\/3\/workflow_steps\/c7548dd9-1a9c-4e00-963c-ccb2f542b448",
            "sourceStep": "\/api\/3\/workflow_steps\/20790c61-9a17-47c5-b80d-d8949c86699a",
            "label": null,
            "isExecuted": false,
            "uuid": "e1e4f32d-e0bf-4db5-9bb3-309c71524040"
        },
        {
            "@type": "WorkflowRoute",
            "name": "is VM snapshot required -> Take snapshot of machine",
            "targetStep": "\/api\/3\/workflow_steps\/d72fd909-1785-4e0b-a1a8-bf0691643f2f",
            "sourceStep": "\/api\/3\/workflow_steps\/c7548dd9-1a9c-4e00-963c-ccb2f542b448",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "6262117f-b8a4-4522-accf-ebfecf96e6a7"
        }
    ],
    "priority": null,
    "uuid": "d0ddc35e-cedd-4902-92ac-55155e1be8b8",
    "recordTags": [],
    "id": 998,
    "createUser": "\/api\/3\/appliances\/57545210-2adc-472b-a24f-2df6ee8dfe63",
    "createDate": 1637679107,
    "modifyUser": "\/api\/3\/appliances\/57545210-2adc-472b-a24f-2df6ee8dfe63",
    "modifyDate": 1637679107,
    "owners": [],
    "isPrivate": false
}