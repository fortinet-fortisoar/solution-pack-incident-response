{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Investigate Concurrent login from different geo location",
    "aliasName": null,
    "tag": null,
    "description": "Investigates alerts of type \u2018Concurrent Login\u2019 by checking if the source IP address is in the specified CIDR range, and then performs remediation tasks based on the result.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1636537406,
    "collection": "\/api\/3\/workflow_collections\/59667fcc-7feb-4ba4-a5a2-e03a9287f857",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/fbf6b415-34a1-4a88-93b7-afbc52a5f2d0",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "2f236473-7f06-4a98-9976-4fc66330ef6f",
                "resources": [
                    "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "records": "{{vars.input.records}}"
                    },
                    "alert_metadata": "{{vars.input.records[0].sourcedata | toDict}}"
                },
                "displayConditions": {
                    "alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": [
                            {
                                "type": "object",
                                "field": "type",
                                "value": "\/api\/3\/picklists\/72459a5f-7759-4cff-a8ac-fa673113c4d0",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/72459a5f-7759-4cff-a8ac-fa673113c4d0",
                                    "display": "Concurrent Login",
                                    "itemValue": "Concurrent Login"
                                },
                                "operator": "eq"
                            }
                        ]
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "uuid": "fbf6b415-34a1-4a88-93b7-afbc52a5f2d0",
            "id": 995
        },
        {
            "@type": "WorkflowStep",
            "name": "Configurations",
            "description": null,
            "arguments": {
                "destIP": "{{vars.alert_metadata.\nassociated_events.event_details[0][0].attributes.destIpAddr}}",
                "userid": "{{vars.alert_metadata.associated_events.event_details[0][0].attributes.srcUser}}",
                "HrEmail": "hr.dept@example.com",
                "username": "{{vars.alert_metadata.associated_events.event_details[0][0].attributes.userFullName}}",
                "ITdeptEmail": "it.dept@exampl.com",
                "VT_Threshold": "5",
                "useMockOutput": "{{globalVars.Demo_mode}}",
                "rawEventMessage": "DB Login Success",
                "internal_cidr_ranges": "193.200.225.0\/24"
            },
            "status": null,
            "top": "165",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "c8d029cb-a6f4-4cdb-9de7-f390fc37d605",
            "id": 996
        },
        {
            "@type": "WorkflowStep",
            "name": "Retrieve Users Details From AD",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "a5a06e4a-2523-49ef-8afc-b05ba05bf65f",
                "params": {
                    "cookie": "",
                    "page_size": "",
                    "size_limit": "",
                    "search_object": "User",
                    "search_attr_name": "Name",
                    "search_attr_value": "{{vars.userid}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "global_search",
                "mock_result": "{\n  \"data\": {\n    \"cookie\": \"\",\n    \"entries\": [\n      {\n        \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n        \"attributes\": {\n          \"c\": \"IN\",\n          \"l\": \"Pune\",\n          \"cn\": \"Tony Stark\",\n          \"co\": \"India\",\n          \"sn\": \"Stark\",\n          \"st\": \"Maharshtra\",\n          \"mail\": \"tonys@outlook.com\",\n          \"name\": \"Tony Stark\",\n          \"title\": \"System Engineer\",\n          \"manager\": \"CN=Bob M,CN=Users,DC=cspune,DC=com\",\n          \"codePage\": 0,\n          \"givenName\": \"Tony\",\n          \"lastLogon\": 1610694904,\n          \"objectSid\": \"S-1-5-21-3252237415-4094437703-262466058-1217\",\n          \"department\": \"IT\",\n          \"lastLogoff\": null,\n          \"logonCount\": 1610694981,\n          \"objectGUID\": \"{99c1d25e-d9f5-4f07-b9bf-ae0b1b4b2e0a}\",\n          \"postalCode\": \"412352\",\n          \"pwdLastSet\": 1603201135,\n          \"uSNChanged\": 100817,\n          \"uSNCreated\": 100808,\n          \"badPwdCount\": 0,\n          \"countryCode\": 356,\n          \"displayName\": \"Tony Stark\",\n          \"objectClass\": [\n            \"top\",\n            \"person\",\n            \"organizationalPerson\",\n            \"user\"\n          ],\n          \"whenChanged\": 1603201241,\n          \"whenCreated\": 1603201135,\n          \"instanceType\": 4,\n          \"accountExpires\": 253402300799,\n          \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=cspune,DC=com\",\n          \"primaryGroupID\": 513,\n          \"sAMAccountName\": \"tonys\",\n          \"sAMAccountType\": \"SAM_NORMAL_USER_ACCOUNT\",\n          \"badPasswordTime\": null,\n          \"distinguishedName\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n          \"userPrincipalName\": \"example@mail.com\",\n          \"userAccountControl\": \"USER_ACCOUNT_DISABLED | NORMAL_ACCOUNT\",\n          \"dSCorePropagationData\": [\n            1603201135,\n            null\n          ]\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Global Search",
                "step_variables": {
                    "userEmail": "{{vars.result.data.entries[0].attributes.mail}}",
                    "userLoginTime": "{{vars.result.data.entries[0].attributes.lastLogon}}"
                }
            },
            "status": null,
            "top": "840",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "31e081a8-400e-4f14-9ab7-186144ac4476",
            "id": 997
        },
        {
            "@type": "WorkflowStep",
            "name": "Notify User Login disable for one hour",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Received approval from IT Team and user account is disabled.\n\nEmail is sent to User with subject \"{{vars.result.subject}}\"",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "resource": {
                    "to": "{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.mail}}",
                    "body": "Hi {{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}},\n\nWe have observed concurrent login to your account from different geographyical locations\n{% for i in vars.alert_metadata.associated_events.event_details %}\n<li>Location : {{i[0].attributes.srcGeoCountry}}<\/li>\n<li> SourceIP : {{i[0].attributes.srcIpAddr}}<\/li>\n <li>Time : {{i[0].attributes.deviceTime}}\n {%endfor%}\n \n hence we are disabling your account for an hour.Incase of any query Please contact IT Help Desk.\n \n Thank you!",
                    "from": "{{globalVars.Default_Email}}",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Account is disable for 1 hour",
                    "__replace": "",
                    "msgDirection": {
                        "id": 278,
                        "@id": "\/api\/3\/picklists\/971d37f3-738a-43e7-93ff-f39c6686e933",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Draft",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/09b97c81-669a-4ac8-8668-920913f3329b",
                        "itemValue": "Draft",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2055",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "c6f7824b-6525-4953-bc12-2d7eecee4ea3",
            "id": 998
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Approval for Login Disable",
            "description": null,
            "arguments": {
                "resource": {
                    "method": {
                        "id": 116,
                        "@id": "\/api\/3\/picklists\/7a04788b-5128-4288-a0fc-6e82d18c3b7b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "System",
                        "listName": "\/api\/3\/picklist_names\/d7bdd0ba-d721-4324-bec5-410e23f0f485",
                        "itemValue": "System",
                        "orderIndex": 1
                    },
                    "owners": [
                        "\/api\/3\/teams\/6e569c09-3bd4-40f1-98b0-cc994464c3c5"
                    ],
                    "status": {
                        "id": 207,
                        "@id": "\/api\/3\/picklists\/d26464e0-1df4-46c2-a032-018911ba0c40",
                        "icon": null,
                        "uuid": "d26464e0-1df4-46c2-a032-018911ba0c40",
                        "@type": "Picklist",
                        "color": "#bf9937",
                        "listName": "\/api\/3\/picklist_names\/ce294c1f-9318-425f-9a12-2957292f4cbf",
                        "itemValue": "Pending",
                        "orderIndex": 2
                    },
                    "playbookiri": "api\/3\/workflows\/4719c477-28f5-4d8d-9022-f70fe75ccb3d",
                    "playbookname": "Investigate Concurrent login from different geo location",
                    "playbookuuid": "4719c477-28f5-4d8d-9022-f70fe75ccb3d",
                    "approvaldescription": "Approve user disable operation in active directory -\n{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}\nFound concurrent Login attempt from different geo location"
                },
                "collection": "approvals",
                "step_variables": []
            },
            "status": null,
            "top": "1785",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/6832e556-b9c7-497a-babe-feda3bd27dcg",
            "uuid": "9f0c6a76-0f0d-4c91-82cb-d3dea848af04",
            "id": 999
        },
        {
            "@type": "WorkflowStep",
            "name": "Start Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Investigating Potential {{vars.input.records[0].type.itemValue}}, with following fields of interest:\n{% if vars.input.records[0].domain %}Domain: {{vars.input.records[0].domain -}}{% endif %}\n{% if vars.input.records[0].sourceIp %}SourceIP: {{ vars.input.records[0].sourceIp -}}{% endif %}\n{% if vars.input.records[0].destinationIp %}DestinationIP: {{vars.input.records[0].destinationIp -}}{% endif %}\n{% if vars.input.records[0].fileHash %}File Hash: {{vars.input.records[0].fileHash -}}{% endif %}\n{% if vars.input.records[0].computerName %}ComputerName: {{vars.input.records[0].computerName -}}{% endif %}\n{% if vars.input.records[0].processName %}Process: {{vars.input.records[0].processName -}}{% endif %}\n{% if vars.input.records[0].sourceProcess %}SourceProcess: {{vars.input.records[0].sourceProcess -}}{% endif %}\n<br>\n\nObserved Concurrent Login To Account from Below different Geo Location\n{% for i in vars.alert_metadata.associated_events.event_details %}\n* Location : {{i[0].attributes.srcGeoCountry}}\n* SourceIP : {{i[0].attributes.srcIpAddr}}\n {%endfor%}",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 113,
                        "@id": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Investigating",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Investigating",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "9ed67875-5342-4dae-9a6f-4b13a56a0fac",
            "id": 1000
        },
        {
            "@type": "WorkflowStep",
            "name": "Match Source IP in Internal CIDR",
            "description": null,
            "arguments": {
                "name": "CyOps Utilities",
                "params": {
                    "cidr": "{{vars.internal_cidr_ranges}}",
                    "ip_address": "{{vars.item[0].attributes.srcIpAddr}}"
                },
                "version": "3.0.5",
                "for_each": {
                    "item": "{{vars.alert_metadata.associated_events.event_details}}",
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "ip_cidr_check",
                "operationTitle": "Utils: Is IP in CIDR",
                "step_variables": [],
                "operationOutput": {
                    "matched_ips": [],
                    "unmatched_ips": []
                }
            },
            "status": null,
            "top": "435",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "740663f0-291a-49f1-be4e-f9520c2abed3",
            "id": 1001
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Source IP internal",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Internal",
                        "step_iri": "\/api\/3\/workflow_steps\/b5657b02-b3d4-40b3-9738-66ad7d850d12",
                        "condition": "{{ vars.steps.Match_Source_IP_in_Internal_CIDR.data['matched_cidr_ip']  |  length > 0 }}",
                        "step_name": "Create Note for Internal IP"
                    },
                    {
                        "option": "External",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/db7744e6-6e6f-4598-bc1e-1ed3478ea886",
                        "step_name": "Create Note for External IP"
                    }
                ]
            },
            "status": null,
            "top": "570",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "7f1892c0-1245-4759-80e9-a6def730a776",
            "id": 1002
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for Internal IP",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.alert_metadata.aassociated_events.event_details}}",
                    "__bulk": true,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p> Source IP: <strong><\/strong><\/p><li><strong>{{vars.item[0].attributes.srcIpAddr}}<\/strong><\/li> is&nbsp;<span style=\"color: #00ff00;\"><strong>Internal and therfore benign<\/strong><\/span><p><\/p>\n",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "b5657b02-b3d4-40b3-9738-66ad7d850d12",
            "id": 1003
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for External IP",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.alert_metadata.associated_events.event_details}}",
                    "__bulk": true,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p> <span style=\"font-size: 15px; color: #DE7A13;\" class=\"fa fa-exclamation-triangle\"><\/span>&nbsp;Source IP<strong> {{vars.item[0].attributes.srcIpAddr}} is <\/strong><span style=\"background:#e31b1d; color: #fff;\" class=\"badge badge-pill badge-danger\">External<\/span><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "db7744e6-6e6f-4598-bc1e-1ed3478ea886",
            "id": 1004
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for User Details",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Below are end user's Detais found on AD :<\/p>\n<ul style=\"list-style-type: square;\">\n<li><strong>Name<\/strong>:&nbsp;{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}<\/li>\n<li><strong>Email Address<\/strong>:&nbsp;{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.mail}}<\/li>\n<li><strong>Manager Name<\/strong>:&nbsp;{{vars.steps.Retrieve_Manager_Email_Address.data.entries[0].attributes.name}}<\/li>\n<li><strong>Manager's Email Address<\/strong>:&nbsp;{{vars.steps.Retrieve_Manager_Email_Address.data.entries[0].attributes.mail}}<\/li><\/ul>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1110",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "1803bd33-2e7f-41fb-a7c9-a3f12d49a214",
            "id": 1005
        },
        {
            "@type": "WorkflowStep",
            "name": "Retrieve Manager Email Address",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "598c4c8c-08a8-4491-bcb8-2223cb53fc57",
                "params": {
                    "cookie": "",
                    "page_size": "",
                    "size_limit": "",
                    "search_object": "User",
                    "search_attr_name": "Distinguished Name",
                    "search_attr_value": "{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.manager}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "global_search",
                "mock_result": "{\n  \"data\": {\n    \"cookie\": \"\",\n    \"entries\": [\n      {\n        \"dn\": \"CN=Bob M,CN=Users,DC=cspune,DC=com\",\n        \"attributes\": {\n          \"c\": \"IN\",\n          \"l\": \"pune\",\n          \"cn\": \"Bob M\",\n          \"co\": \"India\",\n          \"sn\": \"k\",\n          \"st\": \"MH\",\n          \"info\": \"test\",\n          \"mail\": \"bobm@outlook.com\",\n          \"name\": \"Bob M\",\n          \"mobile\": \"9975865053\",\n          \"manager\": \"CN=Robert Banner,CN=Users,DC=cspune,DC=com\",\n          \"codePage\": 0,\n          \"memberOf\": [\n            \"CN=Remote Management Users,CN=Builtin,DC=cspune,DC=com\",\n            \"CN=Remote Desktop Users,CN=Builtin,DC=cspune,DC=com\",\n            \"CN=Administrators,CN=Builtin,DC=cspune,DC=com\"\n          ],\n          \"givenName\": \"bob\",\n          \"lastLogon\": 1603281092,\n          \"objectSid\": \"S-1-5-21-3252237415-4094437703-262466058-1108\",\n          \"adminCount\": 1,\n          \"lastLogoff\": null,\n          \"logonCount\": 164,\n          \"objectGUID\": \"{e64e35bb-2a69-4405-9f20-c8168cf7366f}\",\n          \"postalCode\": \"411045\",\n          \"pwdLastSet\": 1573025485,\n          \"uSNChanged\": 100806,\n          \"uSNCreated\": 35945,\n          \"badPwdCount\": 0,\n          \"countryCode\": 356,\n          \"displayName\": \"bob m\",\n          \"objectClass\": [\n            \"top\",\n            \"person\",\n            \"organizationalPerson\",\n            \"user\"\n          ],\n          \"whenChanged\": 1603200696,\n          \"whenCreated\": 1573025291,\n          \"instanceType\": 4,\n          \"directReports\": [\n            \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\"\n          ],\n          \"accountExpires\": 253402300799,\n          \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=cspune,DC=com\",\n          \"primaryGroupID\": 513,\n          \"sAMAccountName\": \"bob\",\n          \"sAMAccountType\": \"SAM_NORMAL_USER_ACCOUNT\",\n          \"badPasswordTime\": 1601019205,\n          \"distinguishedName\": \"CN=bob m,CN=Users,DC=cspune,DC=com\",\n          \"userPrincipalName\": \"bobm@cspune.com\",\n          \"lastLogonTimestamp\": 1602583384,\n          \"userAccountControl\": \"NORMAL_ACCOUNT | DONT_EXPIRE_PASSWORD\",\n          \"dSCorePropagationData\": [\n            1595571543,\n            1573027969,\n            null\n          ],\n          \"physicalDeliveryOfficeName\": \"Jarvis, pune\",\n          \"msDS-SupportedEncryptionTypes\": 0\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Global Search",
                "pickFromTenant": false,
                "step_variables": {
                    "manager_email": "{{vars.result.data.entries[0].attributes.email}}"
                }
            },
            "status": null,
            "top": "975",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "05b17826-7985-4d29-a2e1-e3a83f134619",
            "id": 1006
        },
        {
            "@type": "WorkflowStep",
            "name": "Disable User Login",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "ef96f61a-6f92-4f1c-ad93-e6d1eefc3aba",
                "params": {
                    "search_attr_name": "Email",
                    "search_attr_value": "{{vars.userEmail}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "User {{vars.userid}} Account is Disabled for 1 hour",
                    "records": ""
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "disable_user_account",
                "mock_result": "{\n     \"description\": \"Disabled User Account\",\n     \"type\": \"Email\",\n     \"referrals\": \"\",\n     \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n     \"result\": \"Disabled\",\n     \"message\": \"Successful\"\n}",
                "operationTitle": "Disable User Account",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "2190",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "bbb001bb-5271-4463-bdb9-a4269adc35ef",
            "id": 1007
        },
        {
            "@type": "WorkflowStep",
            "name": "Reset Password",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "ef96f61a-6f92-4f1c-ad93-e6d1eefc3aba",
                "params": {
                    "new_password": "Demo@1234",
                    "search_attr_name": "Email",
                    "search_attr_value": "{{vars.userEmail}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Reset the User Password after an Hour",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "reset_password",
                "mock_result": "{\n     \"description\": \"Reset User Password\",\n     \"type\": \"Email\",\n     \"referrals\": \"\",\n     \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n     \"result\": \"Reset Password\",\n     \"message\": \"Successful\"\n}",
                "operationTitle": "Reset Password",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "3000",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "f57bac18-eedf-46df-af91-6a1e4f77fa45",
            "id": 1008
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Email to Manager and IT",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Notified User, Manager, IT Team about Password Reset though Email, please check communications for more details.",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "resource": {
                    "cc": "{{vars.manager_email}}",
                    "to": "{{vars.userEmail}}",
                    "bcc": "{{vars.ITdeptEmail}}",
                    "body": "<p>Hello Team<\/p><\/br>\nWe have observed Multiple Concurrent Login Attempt for User : <b>{{vars.username}}<\/b> and We Reset The password for the user.\n\nThank you.",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Notify User, Manager, IT Team about Password Reset",
                    "__replace": "",
                    "msgDirection": {
                        "id": 278,
                        "@id": "\/api\/3\/picklists\/971d37f3-738a-43e7-93ff-f39c6686e933",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Draft",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/09b97c81-669a-4ac8-8668-920913f3329b",
                        "itemValue": "Draft",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "3135",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "9af422c3-528f-4e2c-b257-d7a50c3b3125",
            "id": 1009
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Approved",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Approved",
                        "step_iri": "\/api\/3\/workflow_steps\/c6f7824b-6525-4953-bc12-2d7eecee4ea3",
                        "condition": "{{ vars.steps.Send_Approval_for_Login_Disable.approved == true }}",
                        "step_name": "Notify User Login disable for one hour"
                    },
                    {
                        "option": "Not Approved",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/da269f2b-0beb-4991-b842-319afab22a01",
                        "step_name": "Add Note for Not Approved"
                    }
                ]
            },
            "status": null,
            "top": "1920",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "88e67abe-e10c-4fb7-96b5-e485755d317f",
            "id": 1010
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Not Approved",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "**User Not Approved to Disable the {{vars.username}} Login.**",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2055",
            "left": "650",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "da269f2b-0beb-4991-b842-319afab22a01",
            "id": 1011
        },
        {
            "@type": "WorkflowStep",
            "name": "Search users 4 hours of login data in fortisiem",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f3a47c5b-8a10-4dfc-9f30-d09778821e57",
                "params": {
                    "start": 0,
                    "value": 4,
                    "perPage": 50,
                    "rel_time": "Hours",
                    "attribute": [
                        "Destination IP",
                        "Raw Event Log"
                    ],
                    "select_clause": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                    "time_selection": "Relative Time",
                    "raw_event_log_value": "{{vars.rawEventMessage}}",
                    "destination_ip_value": "{{vars.destIP}}"
                },
                "version": "4.1.0",
                "connector": "fortinet-fortisiem",
                "operation": "search_events",
                "mock_result": "{\n  \"data\": {\n    \"@start\": \"0\",\n    \"events\": [\n      {\n        \"id\": \"7574069411033098795\",\n        \"nid\": \"7574069411033098795\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:49:48 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:19:47 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='27.60.168.208' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145187530 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:19:47.530' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:49:48+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:48:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:48:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033098795\",\n        \"nid\": \"7574069411033098795\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:30:48 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:19:47 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='27.60.168.208' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145187530 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:19:47.530' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:49:48+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:22:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:22:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:05:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:05:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 16:05:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T16:05:39+05:30\"\n      }\n    ],\n    \"@queryId\": \"690845,1611173376077\",\n    \"@errorCode\": \"0\",\n    \"@totalCount\": \"6\"\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Search Events",
                "pickFromTenant": false,
                "step_variables": {
                    "topFiveEvents": "{{vars.result.data.events[:5]}}"
                }
            },
            "status": null,
            "top": "1245",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "ee5ef1b7-6ed4-4acd-b74e-bfeeaeb71a5a",
            "id": 1012
        },
        {
            "@type": "WorkflowStep",
            "name": "convert CEF to json",
            "description": null,
            "arguments": {
                "params": {
                    "cef_input": "{{vars.item.attributes.rawEventMsg}}"
                },
                "version": "3.0.5",
                "for_each": {
                    "item": "{{vars.topFiveEvents}}",
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "parse_cef",
                "operationTitle": "FSR: Parse CEF String to JSON.",
                "step_variables": []
            },
            "status": null,
            "top": "1380",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "d703e764-adb4-4191-ad53-071579933d23",
            "id": 1013
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note to Alert with searched data",
            "description": null,
            "arguments": {
                "params": {
                    "data": "{{vars.item.data}}",
                    "display": "Vertical",
                    "styling": false,
                    "template": "Stylized with row selection",
                    "row_fields": ""
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Below are the user's 4 hours of login data,displaying top 5 logs:\n<br>\n\n{%for i in vars.result%}\n{{i.data}}\n {%endfor%}",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "version": "3.1.1",
                "for_each": {
                    "item": "{{vars.steps.convert_CEF_to_json}}",
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "1515",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "da84f56e-3d2c-4d13-b5b2-3e66ccf00bd9",
            "id": 1014
        },
        {
            "@type": "WorkflowStep",
            "name": "check if Login Attempted in last 10 min",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f3a47c5b-8a10-4dfc-9f30-d09778821e57",
                "params": {
                    "start": 0,
                    "value": 10,
                    "perPage": "",
                    "rel_time": "Minutes",
                    "attribute": [
                        "Destination IP",
                        "Raw Event Log"
                    ],
                    "select_clause": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                    "time_selection": "Relative Time",
                    "raw_event_log_value": "{{vars.rawEventMessage}}",
                    "destination_ip_value": "{{vars.destIP}}"
                },
                "version": "4.1.0",
                "connector": "fortinet-fortisiem",
                "operation": "search_events",
                "mock_result": "{\n  \"data\": {\n    \"@start\": \"0\",\n    \"events\": [],\n    \"@queryId\": \"690867,1611177163837\",\n    \"@errorCode\": \"0\",\n    \"@totalCount\": \"0\"\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Search Events",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "2595",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "f322b5c9-83d4-4fbf-a737-8c9a66a7073b",
            "id": 1015
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Login Attempted",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/d5abe128-7107-45c3-9d20-4adb97128460",
                        "condition": "{{ vars.steps.check_if_Login_Attempted_in_last_10_min.data.events | length > 0 }}",
                        "step_name": "Add Note for Login Attempt"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/03c531dd-6089-4c34-b865-6f0682df18aa",
                        "step_name": "Add note for login is not attempted"
                    }
                ]
            },
            "status": null,
            "top": "2730",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "976aeaac-54d8-4b98-a5c3-2c226201123b",
            "id": 1016
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Login Attempt",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Observed that login is attempted for last an hour",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2865",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "d5abe128-7107-45c3-9d20-4adb97128460",
            "id": 1017
        },
        {
            "@type": "WorkflowStep",
            "name": "Add note for login is not attempted",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Observed that login is not attempted for last an hour",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2865",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "03c531dd-6089-4c34-b865-6f0682df18aa",
            "id": 1018
        },
        {
            "@type": "WorkflowStep",
            "name": "Wait for 1 hour",
            "description": null,
            "arguments": {
                "delay": {
                    "days": 0,
                    "hours": 0,
                    "weeks": 0,
                    "minutes": 1,
                    "seconds": 0
                }
            },
            "status": null,
            "top": "2460",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/6832e556-b9c7-497a-babe-feda3bd27dbf",
            "uuid": "ad02c522-a7d0-44e4-8597-88d14fbcc961",
            "id": 1019
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Approval",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Sent Approval Request To **IT Team** to Disable User Account",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1650",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "da412a50-bb6f-452c-b664-c258532584ee",
            "id": 1020
        },
        {
            "@type": "WorkflowStep",
            "name": "Add note for pause",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Automation workflow snoozed for an hour, Post that we will query for any successfull login attempt",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2325",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "a48a4ba6-3a12-4eeb-84c1-66a23c02df76",
            "id": 1021
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configurations",
            "targetStep": "\/api\/3\/workflow_steps\/c8d029cb-a6f4-4cdb-9de7-f390fc37d605",
            "sourceStep": "\/api\/3\/workflow_steps\/fbf6b415-34a1-4a88-93b7-afbc52a5f2d0",
            "label": null,
            "isExecuted": false,
            "uuid": "fe1baa46-2427-4949-a3e0-455173bcc679"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Match Source IP in Internal CIDR -> Is Source IP internal",
            "targetStep": "\/api\/3\/workflow_steps\/7f1892c0-1245-4759-80e9-a6def730a776",
            "sourceStep": "\/api\/3\/workflow_steps\/740663f0-291a-49f1-be4e-f9520c2abed3",
            "label": null,
            "isExecuted": false,
            "uuid": "04c3a392-0580-401b-88f2-a9fd595f631b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configurations -> Start Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/9ed67875-5342-4dae-9a6f-4b13a56a0fac",
            "sourceStep": "\/api\/3\/workflow_steps\/c8d029cb-a6f4-4cdb-9de7-f390fc37d605",
            "label": null,
            "isExecuted": false,
            "uuid": "829c475e-1c33-4d03-851c-feef271303f8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Investigation -> Match Source IP in Internal CIDR",
            "targetStep": "\/api\/3\/workflow_steps\/740663f0-291a-49f1-be4e-f9520c2abed3",
            "sourceStep": "\/api\/3\/workflow_steps\/9ed67875-5342-4dae-9a6f-4b13a56a0fac",
            "label": null,
            "isExecuted": false,
            "uuid": "3d7508c0-7888-418e-9155-7b913220bee3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Source IP internal -> Create Note for Internal IP",
            "targetStep": "\/api\/3\/workflow_steps\/b5657b02-b3d4-40b3-9738-66ad7d850d12",
            "sourceStep": "\/api\/3\/workflow_steps\/7f1892c0-1245-4759-80e9-a6def730a776",
            "label": "Internal",
            "isExecuted": false,
            "uuid": "91864fd0-0201-4d96-9bfd-252f758df9cc"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Source IP internal -> Create Note for External IP",
            "targetStep": "\/api\/3\/workflow_steps\/db7744e6-6e6f-4598-bc1e-1ed3478ea886",
            "sourceStep": "\/api\/3\/workflow_steps\/7f1892c0-1245-4759-80e9-a6def730a776",
            "label": "External",
            "isExecuted": false,
            "uuid": "96ee84a7-d8be-46b7-900a-b8d18f27b37d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Retrieve Users Details From AD -> Retrieve Manager Email Address",
            "targetStep": "\/api\/3\/workflow_steps\/05b17826-7985-4d29-a2e1-e3a83f134619",
            "sourceStep": "\/api\/3\/workflow_steps\/31e081a8-400e-4f14-9ab7-186144ac4476",
            "label": null,
            "isExecuted": false,
            "uuid": "d22e632a-2bc2-4174-8b7b-67d6aef94ff6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Retrieve Manager Email Address -> Add Note for User Details",
            "targetStep": "\/api\/3\/workflow_steps\/1803bd33-2e7f-41fb-a7c9-a3f12d49a214",
            "sourceStep": "\/api\/3\/workflow_steps\/05b17826-7985-4d29-a2e1-e3a83f134619",
            "label": null,
            "isExecuted": false,
            "uuid": "f0c789ea-2217-406e-8c96-9280d93a9715"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Reset Password -> Notify Manager about Password Reset",
            "targetStep": "\/api\/3\/workflow_steps\/9af422c3-528f-4e2c-b257-d7a50c3b3125",
            "sourceStep": "\/api\/3\/workflow_steps\/f57bac18-eedf-46df-af91-6a1e4f77fa45",
            "label": null,
            "isExecuted": false,
            "uuid": "9c900817-fadd-4f4e-9a52-36b3a0b94894"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Notify User Login disable for one hour -> Disable User Login",
            "targetStep": "\/api\/3\/workflow_steps\/bbb001bb-5271-4463-bdb9-a4269adc35ef",
            "sourceStep": "\/api\/3\/workflow_steps\/c6f7824b-6525-4953-bc12-2d7eecee4ea3",
            "label": null,
            "isExecuted": false,
            "uuid": "93ac27bf-c3e0-49b0-8045-4f5f34e501f4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Approval for Login Disable -> Check if Approved",
            "targetStep": "\/api\/3\/workflow_steps\/88e67abe-e10c-4fb7-96b5-e485755d317f",
            "sourceStep": "\/api\/3\/workflow_steps\/9f0c6a76-0f0d-4c91-82cb-d3dea848af04",
            "label": null,
            "isExecuted": false,
            "uuid": "6fdbaad9-2b06-41a9-bb49-5e53b822d1fd"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Approved -> Notify User Login disable for one hour",
            "targetStep": "\/api\/3\/workflow_steps\/c6f7824b-6525-4953-bc12-2d7eecee4ea3",
            "sourceStep": "\/api\/3\/workflow_steps\/88e67abe-e10c-4fb7-96b5-e485755d317f",
            "label": "Approved",
            "isExecuted": false,
            "uuid": "8e30285c-4246-40e5-8b22-564c418cd66c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Approved -> Add Note for Not Approved",
            "targetStep": "\/api\/3\/workflow_steps\/da269f2b-0beb-4991-b842-319afab22a01",
            "sourceStep": "\/api\/3\/workflow_steps\/88e67abe-e10c-4fb7-96b5-e485755d317f",
            "label": "Not Approved",
            "isExecuted": false,
            "uuid": "5fb83fa1-cc6a-4dec-85d1-20f4aae9def8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Note for External IP -> Retrieve Users Details From AD",
            "targetStep": "\/api\/3\/workflow_steps\/31e081a8-400e-4f14-9ab7-186144ac4476",
            "sourceStep": "\/api\/3\/workflow_steps\/db7744e6-6e6f-4598-bc1e-1ed3478ea886",
            "label": null,
            "isExecuted": false,
            "uuid": "56f586c3-1914-466a-a969-28ccaaae9b3f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "convert CEF to json -> Add Note to Alert with searched data",
            "targetStep": "\/api\/3\/workflow_steps\/da84f56e-3d2c-4d13-b5b2-3e66ccf00bd9",
            "sourceStep": "\/api\/3\/workflow_steps\/d703e764-adb4-4191-ad53-071579933d23",
            "label": null,
            "isExecuted": false,
            "uuid": "958d01bb-7223-4dae-b94b-89f9983f38fb"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for User Details -> searching users 4 hours of login data in fortisiem",
            "targetStep": "\/api\/3\/workflow_steps\/ee5ef1b7-6ed4-4acd-b74e-bfeeaeb71a5a",
            "sourceStep": "\/api\/3\/workflow_steps\/1803bd33-2e7f-41fb-a7c9-a3f12d49a214",
            "label": null,
            "isExecuted": false,
            "uuid": "4c1159a3-46a9-4fe0-a633-c4e85c414448"
        },
        {
            "@type": "WorkflowRoute",
            "name": "check if Login Attempted in last 10 min -> Check if Login Attempted",
            "targetStep": "\/api\/3\/workflow_steps\/976aeaac-54d8-4b98-a5c3-2c226201123b",
            "sourceStep": "\/api\/3\/workflow_steps\/f322b5c9-83d4-4fbf-a737-8c9a66a7073b",
            "label": null,
            "isExecuted": false,
            "uuid": "79bd243a-f88f-4703-a4e6-844bff490ff7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Login Attempt -> Reset Password",
            "targetStep": "\/api\/3\/workflow_steps\/f57bac18-eedf-46df-af91-6a1e4f77fa45",
            "sourceStep": "\/api\/3\/workflow_steps\/d5abe128-7107-45c3-9d20-4adb97128460",
            "label": null,
            "isExecuted": false,
            "uuid": "f1662934-d50c-4a7f-bacd-db07cdd81330"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add note for login is not attempted -> Reset Password",
            "targetStep": "\/api\/3\/workflow_steps\/f57bac18-eedf-46df-af91-6a1e4f77fa45",
            "sourceStep": "\/api\/3\/workflow_steps\/03c531dd-6089-4c34-b865-6f0682df18aa",
            "label": null,
            "isExecuted": false,
            "uuid": "0ed1be64-d0ec-426d-80a6-39ca70d137fc"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Login Attempted -> Add Note for Login Attempt",
            "targetStep": "\/api\/3\/workflow_steps\/d5abe128-7107-45c3-9d20-4adb97128460",
            "sourceStep": "\/api\/3\/workflow_steps\/976aeaac-54d8-4b98-a5c3-2c226201123b",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "0d35f50e-3372-4eca-baf0-851651b8f1f8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Login Attempted -> Add note for login is not attempted",
            "targetStep": "\/api\/3\/workflow_steps\/03c531dd-6089-4c34-b865-6f0682df18aa",
            "sourceStep": "\/api\/3\/workflow_steps\/976aeaac-54d8-4b98-a5c3-2c226201123b",
            "label": "No",
            "isExecuted": false,
            "uuid": "129a886f-b4d8-47a3-aa4f-fe0257097386"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Wait for 1 hour -> check if Login Attempted in last 10 min",
            "targetStep": "\/api\/3\/workflow_steps\/f322b5c9-83d4-4fbf-a737-8c9a66a7073b",
            "sourceStep": "\/api\/3\/workflow_steps\/ad02c522-a7d0-44e4-8597-88d14fbcc961",
            "label": null,
            "isExecuted": false,
            "uuid": "93c305b1-934c-4dc0-88f4-902450eb0837"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note to Alert with searched data -> Add Note for Approval",
            "targetStep": "\/api\/3\/workflow_steps\/da412a50-bb6f-452c-b664-c258532584ee",
            "sourceStep": "\/api\/3\/workflow_steps\/da84f56e-3d2c-4d13-b5b2-3e66ccf00bd9",
            "label": null,
            "isExecuted": false,
            "uuid": "89059192-5a2c-476d-94e4-8fcdfd728264"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Approval -> Send Approval for Login Disable",
            "targetStep": "\/api\/3\/workflow_steps\/9f0c6a76-0f0d-4c91-82cb-d3dea848af04",
            "sourceStep": "\/api\/3\/workflow_steps\/da412a50-bb6f-452c-b664-c258532584ee",
            "label": null,
            "isExecuted": false,
            "uuid": "01f91265-af8c-4b0f-a678-055319b24129"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Disable User Login -> Add note for pause",
            "targetStep": "\/api\/3\/workflow_steps\/a48a4ba6-3a12-4eeb-84c1-66a23c02df76",
            "sourceStep": "\/api\/3\/workflow_steps\/bbb001bb-5271-4463-bdb9-a4269adc35ef",
            "label": null,
            "isExecuted": false,
            "uuid": "7eb386cd-f309-4c75-accc-56f3acfa7bba"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add note for pause -> Wait for 1 hour",
            "targetStep": "\/api\/3\/workflow_steps\/ad02c522-a7d0-44e4-8597-88d14fbcc961",
            "sourceStep": "\/api\/3\/workflow_steps\/a48a4ba6-3a12-4eeb-84c1-66a23c02df76",
            "label": null,
            "isExecuted": false,
            "uuid": "1427c841-c303-4d67-af9f-51e978aabbec"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Search users 4 hours of login data in fortisiem -> convert CEF to json",
            "targetStep": "\/api\/3\/workflow_steps\/d703e764-adb4-4191-ad53-071579933d23",
            "sourceStep": "\/api\/3\/workflow_steps\/ee5ef1b7-6ed4-4acd-b74e-bfeeaeb71a5a",
            "label": null,
            "isExecuted": false,
            "uuid": "7c145ca4-1de8-4547-81b5-751bf224c3ba"
        }
    ],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "4719c477-28f5-4d8d-9022-f70fe75ccb3d",
    "recordTags": [
        "ManualAction"
    ],
    "id": 144,
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1636537415,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1636537415,
    "owners": [],
    "isPrivate": false
}