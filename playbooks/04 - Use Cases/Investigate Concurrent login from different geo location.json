{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Investigate Concurrent login from different geo location",
    "aliasName": null,
    "tag": null,
    "description": "Investigates alerts of type \u2018Concurrent Login\u2019 by checking if the source IP address is in the specified CIDR range, and then performs remediation tasks based on the result.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1637679100,
    "collection": "\/api\/3\/workflow_collections\/59667fcc-7feb-4ba4-a5a2-e03a9287f857",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/54e7fa55-3e4d-4c56-b61b-4069c4942c72",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "2f236473-7f06-4a98-9976-4fc66330ef6f",
                "resources": [
                    "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "records": "{{vars.input.records}}"
                    },
                    "alert_metadata": "{{vars.input.records[0].sourcedata | toDict}}"
                },
                "displayConditions": {
                    "alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": [
                            {
                                "type": "object",
                                "field": "type",
                                "value": "\/api\/3\/picklists\/72459a5f-7759-4cff-a8ac-fa673113c4d0",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/72459a5f-7759-4cff-a8ac-fa673113c4d0",
                                    "display": "Concurrent Login",
                                    "itemValue": "Concurrent Login"
                                },
                                "operator": "eq"
                            }
                        ]
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "uuid": "54e7fa55-3e4d-4c56-b61b-4069c4942c72",
            "id": 3192
        },
        {
            "@type": "WorkflowStep",
            "name": "Configurations",
            "description": null,
            "arguments": {
                "destIP": "{{vars.alert_metadata.\nassociated_events.event_details[0][0].attributes.destIpAddr}}",
                "userid": "{{vars.alert_metadata.associated_events.event_details[0][0].attributes.srcUser}}",
                "HrEmail": "hr.dept@example.com",
                "username": "{{vars.alert_metadata.associated_events.event_details[0][0].attributes.userFullName}}",
                "ITdeptEmail": "it.dept@exampl.com",
                "VT_Threshold": "5",
                "useMockOutput": "{{globalVars.Demo_mode}}",
                "rawEventMessage": "DB Login Success",
                "internal_cidr_ranges": "193.200.225.0\/24"
            },
            "status": null,
            "top": "165",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "528da244-a898-42d7-86c4-1c0d2de03e35",
            "id": 3193
        },
        {
            "@type": "WorkflowStep",
            "name": "Retrieve Users Details From AD",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "a5a06e4a-2523-49ef-8afc-b05ba05bf65f",
                "params": {
                    "cookie": "",
                    "page_size": "",
                    "size_limit": "",
                    "search_object": "User",
                    "search_attr_name": "Name",
                    "search_attr_value": "{{vars.userid}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "global_search",
                "mock_result": "{\n  \"data\": {\n    \"cookie\": \"\",\n    \"entries\": [\n      {\n        \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n        \"attributes\": {\n          \"c\": \"IN\",\n          \"l\": \"Pune\",\n          \"cn\": \"Tony Stark\",\n          \"co\": \"India\",\n          \"sn\": \"Stark\",\n          \"st\": \"Maharshtra\",\n          \"mail\": \"tonys@outlook.com\",\n          \"name\": \"Tony Stark\",\n          \"title\": \"System Engineer\",\n          \"manager\": \"CN=Bob M,CN=Users,DC=cspune,DC=com\",\n          \"codePage\": 0,\n          \"givenName\": \"Tony\",\n          \"lastLogon\": 1610694904,\n          \"objectSid\": \"S-1-5-21-3252237415-4094437703-262466058-1217\",\n          \"department\": \"IT\",\n          \"lastLogoff\": null,\n          \"logonCount\": 1610694981,\n          \"objectGUID\": \"{99c1d25e-d9f5-4f07-b9bf-ae0b1b4b2e0a}\",\n          \"postalCode\": \"412352\",\n          \"pwdLastSet\": 1603201135,\n          \"uSNChanged\": 100817,\n          \"uSNCreated\": 100808,\n          \"badPwdCount\": 0,\n          \"countryCode\": 356,\n          \"displayName\": \"Tony Stark\",\n          \"objectClass\": [\n            \"top\",\n            \"person\",\n            \"organizationalPerson\",\n            \"user\"\n          ],\n          \"whenChanged\": 1603201241,\n          \"whenCreated\": 1603201135,\n          \"instanceType\": 4,\n          \"accountExpires\": 253402300799,\n          \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=cspune,DC=com\",\n          \"primaryGroupID\": 513,\n          \"sAMAccountName\": \"tonys\",\n          \"sAMAccountType\": \"SAM_NORMAL_USER_ACCOUNT\",\n          \"badPasswordTime\": null,\n          \"distinguishedName\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n          \"userPrincipalName\": \"example@mail.com\",\n          \"userAccountControl\": \"USER_ACCOUNT_DISABLED | NORMAL_ACCOUNT\",\n          \"dSCorePropagationData\": [\n            1603201135,\n            null\n          ]\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Global Search",
                "step_variables": {
                    "userEmail": "{{vars.result.data.entries[0].attributes.mail}}",
                    "userLoginTime": "{{vars.result.data.entries[0].attributes.lastLogon}}"
                }
            },
            "status": null,
            "top": "840",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "38452871-54a9-40d2-aa7e-e39f32c962e4",
            "id": 3194
        },
        {
            "@type": "WorkflowStep",
            "name": "Notify User Login disable for one hour",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Received approval from IT Team and user account is disabled.\n\nEmail is sent to User with subject \"{{vars.result.subject}}\"",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "resource": {
                    "to": "{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.mail}}",
                    "body": "Hi {{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}},\n\nWe have observed concurrent login to your account from different geographyical locations\n{% for i in vars.alert_metadata.associated_events.event_details %}\n<li>Location : {{i[0].attributes.srcGeoCountry}}<\/li>\n<li> SourceIP : {{i[0].attributes.srcIpAddr}}<\/li>\n <li>Time : {{i[0].attributes.deviceTime}}\n {%endfor%}\n \n hence we are disabling your account for an hour.Incase of any query Please contact IT Help Desk.\n \n Thank you!",
                    "from": "{{globalVars.Default_Email}}",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Account is disable for 1 hour",
                    "__replace": "",
                    "msgDirection": {
                        "id": 278,
                        "@id": "\/api\/3\/picklists\/971d37f3-738a-43e7-93ff-f39c6686e933",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Draft",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/09b97c81-669a-4ac8-8668-920913f3329b",
                        "itemValue": "Draft",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2055",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "4209aa95-0d8e-4f3a-9d60-0cdd0c7da9d1",
            "id": 3195
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Approval for Login Disable",
            "description": null,
            "arguments": {
                "resource": {
                    "method": {
                        "id": 116,
                        "@id": "\/api\/3\/picklists\/7a04788b-5128-4288-a0fc-6e82d18c3b7b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "System",
                        "listName": "\/api\/3\/picklist_names\/d7bdd0ba-d721-4324-bec5-410e23f0f485",
                        "itemValue": "System",
                        "orderIndex": 1
                    },
                    "owners": [
                        "\/api\/3\/teams\/6e569c09-3bd4-40f1-98b0-cc994464c3c5"
                    ],
                    "status": {
                        "id": 207,
                        "@id": "\/api\/3\/picklists\/d26464e0-1df4-46c2-a032-018911ba0c40",
                        "icon": null,
                        "uuid": "d26464e0-1df4-46c2-a032-018911ba0c40",
                        "@type": "Picklist",
                        "color": "#bf9937",
                        "listName": "\/api\/3\/picklist_names\/ce294c1f-9318-425f-9a12-2957292f4cbf",
                        "itemValue": "Pending",
                        "orderIndex": 2
                    },
                    "playbookiri": "api\/3\/workflows\/4719c477-28f5-4d8d-9022-f70fe75ccb3d",
                    "playbookname": "Investigate Concurrent login from different geo location",
                    "playbookuuid": "4719c477-28f5-4d8d-9022-f70fe75ccb3d",
                    "approvaldescription": "Approve user disable operation in active directory -\n{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}\nFound concurrent Login attempt from different geo location"
                },
                "collection": "approvals",
                "step_variables": []
            },
            "status": null,
            "top": "1785",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/6832e556-b9c7-497a-babe-feda3bd27dcg",
            "uuid": "946a0e3a-423d-45c8-91f3-53b11b207afd",
            "id": 3196
        },
        {
            "@type": "WorkflowStep",
            "name": "Start Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Investigating Potential {{vars.input.records[0].type.itemValue}}, with following fields of interest:\n{% if vars.input.records[0].domain %}Domain: {{vars.input.records[0].domain -}}{% endif %}\n{% if vars.input.records[0].sourceIp %}SourceIP: {{ vars.input.records[0].sourceIp -}}{% endif %}\n{% if vars.input.records[0].destinationIp %}DestinationIP: {{vars.input.records[0].destinationIp -}}{% endif %}\n{% if vars.input.records[0].fileHash %}File Hash: {{vars.input.records[0].fileHash -}}{% endif %}\n{% if vars.input.records[0].computerName %}ComputerName: {{vars.input.records[0].computerName -}}{% endif %}\n{% if vars.input.records[0].processName %}Process: {{vars.input.records[0].processName -}}{% endif %}\n{% if vars.input.records[0].sourceProcess %}SourceProcess: {{vars.input.records[0].sourceProcess -}}{% endif %}\n<br>\n\nObserved Concurrent Login To Account from Below different Geo Location\n{% for i in vars.alert_metadata.associated_events.event_details %}\n* Location : {{i[0].attributes.srcGeoCountry}}\n* SourceIP : {{i[0].attributes.srcIpAddr}}\n {%endfor%}",
                    "records": ""
                },
                "resource": {
                    "status": {
                        "id": 113,
                        "@id": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Investigating",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Investigating",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "918422e2-dfd7-4ec8-b060-5f4a97b60659",
            "id": 3197
        },
        {
            "@type": "WorkflowStep",
            "name": "Match Source IP in Internal CIDR",
            "description": null,
            "arguments": {
                "name": "CyOps Utilities",
                "params": {
                    "cidr": "{{vars.internal_cidr_ranges}}",
                    "ip_address": "{{vars.item[0].attributes.srcIpAddr}}"
                },
                "version": "3.0.5",
                "for_each": {
                    "item": "{{vars.alert_metadata.associated_events.event_details}}",
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "ip_cidr_check",
                "operationTitle": "Utils: Is IP in CIDR",
                "step_variables": [],
                "operationOutput": {
                    "matched_ips": [],
                    "unmatched_ips": []
                }
            },
            "status": null,
            "top": "435",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "b5d81b49-a343-4f54-9b77-efae3cc51b54",
            "id": 3198
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Source IP internal",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Internal",
                        "step_iri": "\/api\/3\/workflow_steps\/a4dca7ea-d811-4842-be9a-fde858aae766",
                        "condition": "{{ vars.steps.Match_Source_IP_in_Internal_CIDR.data['matched_cidr_ip']  |  length > 0 }}",
                        "step_name": "Create Note for Internal IP"
                    },
                    {
                        "option": "External",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/06cd91df-ac56-4b16-bb4c-ce4736590da4",
                        "step_name": "Create Note for External IP"
                    }
                ]
            },
            "status": null,
            "top": "570",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "3a5ea1b9-43c2-41cf-94b4-a8de1800cb4f",
            "id": 3199
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for Internal IP",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.alert_metadata.aassociated_events.event_details}}",
                    "__bulk": true,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p> Source IP: <strong><\/strong><\/p><li><strong>{{vars.item[0].attributes.srcIpAddr}}<\/strong><\/li> is&nbsp;<span style=\"color: #00ff00;\"><strong>Internal and therfore benign<\/strong><\/span><p><\/p>\n",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "a4dca7ea-d811-4842-be9a-fde858aae766",
            "id": 3200
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Note for External IP",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.alert_metadata.associated_events.event_details}}",
                    "__bulk": true,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "[\"{{vars.input.records[0]['@id']}}\"]",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p> <span style=\"font-size: 15px; color: #DE7A13;\" class=\"fa fa-exclamation-triangle\"><\/span>&nbsp;Source IP<strong> {{vars.item[0].attributes.srcIpAddr}} is <\/strong><span style=\"background:#e31b1d; color: #fff;\" class=\"badge badge-pill badge-danger\">External<\/span><\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "06cd91df-ac56-4b16-bb4c-ce4736590da4",
            "id": 3201
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for User Details",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>Below are end user's Detais found on AD :<\/p>\n<ul style=\"list-style-type: square;\">\n<li><strong>Name<\/strong>:&nbsp;{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.name}}<\/li>\n<li><strong>Email Address<\/strong>:&nbsp;{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.mail}}<\/li>\n<li><strong>Manager Name<\/strong>:&nbsp;{{vars.steps.Retrieve_Manager_Email_Address.data.entries[0].attributes.name}}<\/li>\n<li><strong>Manager's Email Address<\/strong>:&nbsp;{{vars.steps.Retrieve_Manager_Email_Address.data.entries[0].attributes.mail}}<\/li><\/ul>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1110",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "72f1dcdf-6cf3-49c0-afe6-460bb3b09fb8",
            "id": 3202
        },
        {
            "@type": "WorkflowStep",
            "name": "Retrieve Manager Email Address",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "598c4c8c-08a8-4491-bcb8-2223cb53fc57",
                "params": {
                    "cookie": "",
                    "page_size": "",
                    "size_limit": "",
                    "search_object": "User",
                    "search_attr_name": "Distinguished Name",
                    "search_attr_value": "{{vars.steps.Retrieve_Users_Details_From_AD.data.entries[0].attributes.manager}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "global_search",
                "mock_result": "{\n  \"data\": {\n    \"cookie\": \"\",\n    \"entries\": [\n      {\n        \"dn\": \"CN=Bob M,CN=Users,DC=cspune,DC=com\",\n        \"attributes\": {\n          \"c\": \"IN\",\n          \"l\": \"pune\",\n          \"cn\": \"Bob M\",\n          \"co\": \"India\",\n          \"sn\": \"k\",\n          \"st\": \"MH\",\n          \"info\": \"test\",\n          \"mail\": \"bobm@outlook.com\",\n          \"name\": \"Bob M\",\n          \"mobile\": \"9975865053\",\n          \"manager\": \"CN=Robert Banner,CN=Users,DC=cspune,DC=com\",\n          \"codePage\": 0,\n          \"memberOf\": [\n            \"CN=Remote Management Users,CN=Builtin,DC=cspune,DC=com\",\n            \"CN=Remote Desktop Users,CN=Builtin,DC=cspune,DC=com\",\n            \"CN=Administrators,CN=Builtin,DC=cspune,DC=com\"\n          ],\n          \"givenName\": \"bob\",\n          \"lastLogon\": 1603281092,\n          \"objectSid\": \"S-1-5-21-3252237415-4094437703-262466058-1108\",\n          \"adminCount\": 1,\n          \"lastLogoff\": null,\n          \"logonCount\": 164,\n          \"objectGUID\": \"{e64e35bb-2a69-4405-9f20-c8168cf7366f}\",\n          \"postalCode\": \"411045\",\n          \"pwdLastSet\": 1573025485,\n          \"uSNChanged\": 100806,\n          \"uSNCreated\": 35945,\n          \"badPwdCount\": 0,\n          \"countryCode\": 356,\n          \"displayName\": \"bob m\",\n          \"objectClass\": [\n            \"top\",\n            \"person\",\n            \"organizationalPerson\",\n            \"user\"\n          ],\n          \"whenChanged\": 1603200696,\n          \"whenCreated\": 1573025291,\n          \"instanceType\": 4,\n          \"directReports\": [\n            \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\"\n          ],\n          \"accountExpires\": 253402300799,\n          \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=cspune,DC=com\",\n          \"primaryGroupID\": 513,\n          \"sAMAccountName\": \"bob\",\n          \"sAMAccountType\": \"SAM_NORMAL_USER_ACCOUNT\",\n          \"badPasswordTime\": 1601019205,\n          \"distinguishedName\": \"CN=bob m,CN=Users,DC=cspune,DC=com\",\n          \"userPrincipalName\": \"bobm@cspune.com\",\n          \"lastLogonTimestamp\": 1602583384,\n          \"userAccountControl\": \"NORMAL_ACCOUNT | DONT_EXPIRE_PASSWORD\",\n          \"dSCorePropagationData\": [\n            1595571543,\n            1573027969,\n            null\n          ],\n          \"physicalDeliveryOfficeName\": \"Jarvis, pune\",\n          \"msDS-SupportedEncryptionTypes\": 0\n        }\n      }\n    ]\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Global Search",
                "pickFromTenant": false,
                "step_variables": {
                    "manager_email": "{{vars.result.data.entries[0].attributes.email}}"
                }
            },
            "status": null,
            "top": "975",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "32086538-258f-440b-b66b-e5b8dcc22360",
            "id": 3203
        },
        {
            "@type": "WorkflowStep",
            "name": "Disable User Login",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "ef96f61a-6f92-4f1c-ad93-e6d1eefc3aba",
                "params": {
                    "search_attr_name": "Email",
                    "search_attr_value": "{{vars.userEmail}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "User {{vars.userid}} Account is Disabled for 1 hour",
                    "records": ""
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "disable_user_account",
                "mock_result": "{\n     \"description\": \"Disabled User Account\",\n     \"type\": \"Email\",\n     \"referrals\": \"\",\n     \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n     \"result\": \"Disabled\",\n     \"message\": \"Successful\"\n}",
                "operationTitle": "Disable User Account",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "2190",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "f31dfa7b-34b9-4d8a-8488-7426863d95ac",
            "id": 3204
        },
        {
            "@type": "WorkflowStep",
            "name": "Reset Password",
            "description": null,
            "arguments": {
                "name": "Active Directory",
                "config": "ef96f61a-6f92-4f1c-ad93-e6d1eefc3aba",
                "params": {
                    "new_password": "Demo@1234",
                    "search_attr_name": "Email",
                    "search_attr_value": "{{vars.userEmail}}"
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Reset the User Password after an Hour",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "version": "2.1.1",
                "connector": "activedirectory",
                "operation": "reset_password",
                "mock_result": "{\n     \"description\": \"Reset User Password\",\n     \"type\": \"Email\",\n     \"referrals\": \"\",\n     \"dn\": \"CN=Tony Stark,CN=Users,DC=cspune,DC=com\",\n     \"result\": \"Reset Password\",\n     \"message\": \"Successful\"\n}",
                "operationTitle": "Reset Password",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "3000",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "9b4b232c-6b41-4fbc-b0bc-234ff94b166b",
            "id": 3205
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Email to Manager and IT",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Notified User, Manager, IT Team about Password Reset though Email, please check communications for more details.",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "resource": {
                    "cc": "{{vars.manager_email}}",
                    "to": "{{vars.userEmail}}",
                    "bcc": "{{vars.ITdeptEmail}}",
                    "body": "<p>Hello Team<\/p><\/br>\nWe have observed Multiple Concurrent Login Attempt for User : <b>{{vars.username}}<\/b> and We Reset The password for the user.\n\nThank you.",
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "subject": "Notify User, Manager, IT Team about Password Reset",
                    "__replace": "",
                    "msgDirection": {
                        "id": 278,
                        "@id": "\/api\/3\/picklists\/971d37f3-738a-43e7-93ff-f39c6686e933",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Draft",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/09b97c81-669a-4ac8-8668-920913f3329b",
                        "itemValue": "Draft",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/communication",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "3135",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "efba2586-eafc-43f7-8cf0-a584f3bf5fbc",
            "id": 3206
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Approved",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Approved",
                        "step_iri": "\/api\/3\/workflow_steps\/4209aa95-0d8e-4f3a-9d60-0cdd0c7da9d1",
                        "condition": "{{ vars.steps.Send_Approval_for_Login_Disable.approved == true }}",
                        "step_name": "Notify User Login disable for one hour"
                    },
                    {
                        "option": "Not Approved",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/cd3b063c-66a9-4340-8870-649a13b594ff",
                        "step_name": "Add Note for Not Approved"
                    }
                ]
            },
            "status": null,
            "top": "1920",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "793438dc-536b-431f-9e9c-4d9d95c89725",
            "id": 3207
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Not Approved",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "**User Not Approved to Disable the {{vars.username}} Login.**",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2055",
            "left": "650",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "cd3b063c-66a9-4340-8870-649a13b594ff",
            "id": 3208
        },
        {
            "@type": "WorkflowStep",
            "name": "Search users 4 hours of login data in fortisiem",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f3a47c5b-8a10-4dfc-9f30-d09778821e57",
                "params": {
                    "start": 0,
                    "value": 4,
                    "perPage": 50,
                    "rel_time": "Hours",
                    "attribute": [
                        "Destination IP",
                        "Raw Event Log"
                    ],
                    "select_clause": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                    "time_selection": "Relative Time",
                    "raw_event_log_value": "{{vars.rawEventMessage}}",
                    "destination_ip_value": "{{vars.destIP}}"
                },
                "version": "4.1.0",
                "connector": "fortinet-fortisiem",
                "operation": "search_events",
                "mock_result": "{\n  \"data\": {\n    \"@start\": \"0\",\n    \"events\": [\n      {\n        \"id\": \"7574069411033098795\",\n        \"nid\": \"7574069411033098795\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:49:48 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:19:47 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='27.60.168.208' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145187530 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:19:47.530' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:49:48+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:48:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:48:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033098795\",\n        \"nid\": \"7574069411033098795\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:30:48 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:19:47 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='27.60.168.208' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145187530 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:19:47.530' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:49:48+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:22:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:22:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 17:05:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T17:05:39+05:30\"\n      },\n      {\n        \"id\": \"7574069411033008504\",\n        \"nid\": \"7574069411033008504\",\n        \"index\": \"1\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Unknown_EventType\",\n        \"attributes\": {\n          \"eventName\": \"Unknown event type\",\n          \"eventType\": \"Unknown_EventType\",\n          \"destIpAddr\": \"10.88.2.254\",\n          \"phRecvTime\": \"Wed Jan 20 16:05:39 IST 2021\",\n          \"rawEventMsg\": \"<179>Jan 20 12:18:39 qa-env2 fortisoar-audit-logs: CEF:0|Fortinet Inc|FortiSOAR|6.4.3|Login Success|10|msg='DB Login Success for user [Tony Stark]' src='37.32.125.134' suid='3451141c-bac6-467c-8d72-85e0fab569ce' suser='Tony Stark' end=1611145119058 playbookName='' playbookId='' eventTimeStr='20 Jan 2021 12:18:39.058' data='null'\",\n          \"reptDevIpAddr\": \"10.88.2.254\"\n        },\n        \"receiveTime\": \"2021-01-20T16:05:39+05:30\"\n      }\n    ],\n    \"@queryId\": \"690845,1611173376077\",\n    \"@errorCode\": \"0\",\n    \"@totalCount\": \"6\"\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Search Events",
                "pickFromTenant": false,
                "step_variables": {
                    "topFiveEvents": "{{vars.result.data.events[:5]}}"
                }
            },
            "status": null,
            "top": "1245",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "bc7c45df-e702-4195-8ba0-667944584e46",
            "id": 3209
        },
        {
            "@type": "WorkflowStep",
            "name": "convert CEF to json",
            "description": null,
            "arguments": {
                "params": {
                    "cef_input": "{{vars.item.attributes.rawEventMsg}}"
                },
                "version": "3.0.5",
                "for_each": {
                    "item": "{{vars.topFiveEvents}}",
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "parse_cef",
                "operationTitle": "FSR: Parse CEF String to JSON.",
                "step_variables": []
            },
            "status": null,
            "top": "1380",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "a0162c7f-65ab-4474-9104-f63a78df9f47",
            "id": 3210
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note to Alert with searched data",
            "description": null,
            "arguments": {
                "params": {
                    "data": "{{vars.item.data}}",
                    "display": "Vertical",
                    "styling": false,
                    "template": "Stylized with row selection",
                    "row_fields": ""
                },
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Below are the user's 4 hours of login data,displaying top 5 logs:\n<br>\n\n{%for i in vars.result%}\n{{i.data}}\n {%endfor%}",
                    "records": "{{vars.input.records[0]['@id']}}"
                },
                "version": "3.1.1",
                "for_each": {
                    "item": "{{vars.steps.convert_CEF_to_json}}",
                    "condition": ""
                },
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "1515",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "34e15fce-a62f-4304-a73b-f46fb14ccac2",
            "id": 3211
        },
        {
            "@type": "WorkflowStep",
            "name": "check if Login Attempted in last 10 min",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f3a47c5b-8a10-4dfc-9f30-d09778821e57",
                "params": {
                    "start": 0,
                    "value": 10,
                    "perPage": "",
                    "rel_time": "Minutes",
                    "attribute": [
                        "Destination IP",
                        "Raw Event Log"
                    ],
                    "select_clause": "phRecvTime,reptDevIpAddr,eventType,eventName,srcIpAddr,destIpAddr,user,rawEventMsg",
                    "time_selection": "Relative Time",
                    "raw_event_log_value": "{{vars.rawEventMessage}}",
                    "destination_ip_value": "{{vars.destIP}}"
                },
                "version": "4.1.0",
                "connector": "fortinet-fortisiem",
                "operation": "search_events",
                "mock_result": "{\n  \"data\": {\n    \"@start\": \"0\",\n    \"events\": [],\n    \"@queryId\": \"690867,1611177163837\",\n    \"@errorCode\": \"0\",\n    \"@totalCount\": \"0\"\n  },\n  \"status\": \"Success\",\n  \"_status\": true,\n  \"message\": \"\",\n  \"operation\": null,\n  \"request_id\": null\n}",
                "operationTitle": "Search Events",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "2595",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "20a1c87e-50fe-4e3a-9e9f-1bb824d4dd95",
            "id": 3212
        },
        {
            "@type": "WorkflowStep",
            "name": "Check if Login Attempted",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/ff2e3745-9271-4a7c-9908-aab8229c8b0c",
                        "condition": "{{ vars.steps.check_if_Login_Attempted_in_last_10_min.data.events | length > 0 }}",
                        "step_name": "Add Note for Login Attempt"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/6f86dc38-1d5b-4492-8f3d-2a0314bc61ef",
                        "step_name": "Add note for login is not attempted"
                    }
                ]
            },
            "status": null,
            "top": "2730",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "fdd39a5c-c7d2-4b39-95c1-73dc21561e4f",
            "id": 3213
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Login Attempt",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Observed that login is attempted for last an hour",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2865",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "ff2e3745-9271-4a7c-9908-aab8229c8b0c",
            "id": 3214
        },
        {
            "@type": "WorkflowStep",
            "name": "Add note for login is not attempted",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Observed that login is not attempted for last an hour",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2865",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "6f86dc38-1d5b-4492-8f3d-2a0314bc61ef",
            "id": 3215
        },
        {
            "@type": "WorkflowStep",
            "name": "Wait for 1 hour",
            "description": null,
            "arguments": {
                "delay": {
                    "days": 0,
                    "hours": 0,
                    "weeks": 0,
                    "minutes": 1,
                    "seconds": 0
                }
            },
            "status": null,
            "top": "2460",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/6832e556-b9c7-497a-babe-feda3bd27dbf",
            "uuid": "c22d047c-ec37-4f6f-915d-017644b21db3",
            "id": 3216
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Note for Approval",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Sent Approval Request To **IT Team** to Disable User Account",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1650",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "714b5b75-7429-418b-87f1-e045349cb1ac",
            "id": 3217
        },
        {
            "@type": "WorkflowStep",
            "name": "Add note for pause",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "Automation workflow snoozed for an hour, Post that we will query for any successfull login attempt",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2325",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "503ec667-67a0-40ed-9dec-5dc2381b2a1a",
            "id": 3218
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configurations",
            "targetStep": "\/api\/3\/workflow_steps\/528da244-a898-42d7-86c4-1c0d2de03e35",
            "sourceStep": "\/api\/3\/workflow_steps\/54e7fa55-3e4d-4c56-b61b-4069c4942c72",
            "label": null,
            "isExecuted": false,
            "uuid": "774307f6-59f6-4bca-9d15-4ff60b58d44e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Match Source IP in Internal CIDR -> Is Source IP internal",
            "targetStep": "\/api\/3\/workflow_steps\/3a5ea1b9-43c2-41cf-94b4-a8de1800cb4f",
            "sourceStep": "\/api\/3\/workflow_steps\/b5d81b49-a343-4f54-9b77-efae3cc51b54",
            "label": null,
            "isExecuted": false,
            "uuid": "5a4e74fe-e886-485e-81dc-82a8816b2670"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configurations -> Start Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/918422e2-dfd7-4ec8-b060-5f4a97b60659",
            "sourceStep": "\/api\/3\/workflow_steps\/528da244-a898-42d7-86c4-1c0d2de03e35",
            "label": null,
            "isExecuted": false,
            "uuid": "7d22dc3f-db72-4a8e-ae9b-60cbce1ea40d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Investigation -> Match Source IP in Internal CIDR",
            "targetStep": "\/api\/3\/workflow_steps\/b5d81b49-a343-4f54-9b77-efae3cc51b54",
            "sourceStep": "\/api\/3\/workflow_steps\/918422e2-dfd7-4ec8-b060-5f4a97b60659",
            "label": null,
            "isExecuted": false,
            "uuid": "0d6350af-a78a-4e17-94e1-80a47ef175d1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Source IP internal -> Create Note for Internal IP",
            "targetStep": "\/api\/3\/workflow_steps\/a4dca7ea-d811-4842-be9a-fde858aae766",
            "sourceStep": "\/api\/3\/workflow_steps\/3a5ea1b9-43c2-41cf-94b4-a8de1800cb4f",
            "label": "Internal",
            "isExecuted": false,
            "uuid": "dd58523a-d01b-42ff-90f6-fd2185e29c85"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Source IP internal -> Create Note for External IP",
            "targetStep": "\/api\/3\/workflow_steps\/06cd91df-ac56-4b16-bb4c-ce4736590da4",
            "sourceStep": "\/api\/3\/workflow_steps\/3a5ea1b9-43c2-41cf-94b4-a8de1800cb4f",
            "label": "External",
            "isExecuted": false,
            "uuid": "d41194f0-275e-4e54-9153-3be92c7fdedf"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Retrieve Users Details From AD -> Retrieve Manager Email Address",
            "targetStep": "\/api\/3\/workflow_steps\/32086538-258f-440b-b66b-e5b8dcc22360",
            "sourceStep": "\/api\/3\/workflow_steps\/38452871-54a9-40d2-aa7e-e39f32c962e4",
            "label": null,
            "isExecuted": false,
            "uuid": "832e6f6c-05d1-4d68-8bbe-17408f2fb7bb"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Retrieve Manager Email Address -> Add Note for User Details",
            "targetStep": "\/api\/3\/workflow_steps\/72f1dcdf-6cf3-49c0-afe6-460bb3b09fb8",
            "sourceStep": "\/api\/3\/workflow_steps\/32086538-258f-440b-b66b-e5b8dcc22360",
            "label": null,
            "isExecuted": false,
            "uuid": "2f34eff7-7e2c-4ad9-b97d-b292d176ddfe"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Reset Password -> Notify Manager about Password Reset",
            "targetStep": "\/api\/3\/workflow_steps\/efba2586-eafc-43f7-8cf0-a584f3bf5fbc",
            "sourceStep": "\/api\/3\/workflow_steps\/9b4b232c-6b41-4fbc-b0bc-234ff94b166b",
            "label": null,
            "isExecuted": false,
            "uuid": "4f8f46cf-b024-48e0-b9ad-39caa18cbbc7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Notify User Login disable for one hour -> Disable User Login",
            "targetStep": "\/api\/3\/workflow_steps\/f31dfa7b-34b9-4d8a-8488-7426863d95ac",
            "sourceStep": "\/api\/3\/workflow_steps\/4209aa95-0d8e-4f3a-9d60-0cdd0c7da9d1",
            "label": null,
            "isExecuted": false,
            "uuid": "8908092e-3196-46a8-908f-8a824bc0275d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Approval for Login Disable -> Check if Approved",
            "targetStep": "\/api\/3\/workflow_steps\/793438dc-536b-431f-9e9c-4d9d95c89725",
            "sourceStep": "\/api\/3\/workflow_steps\/946a0e3a-423d-45c8-91f3-53b11b207afd",
            "label": null,
            "isExecuted": false,
            "uuid": "133718ce-6337-4718-8c73-eaced0b51620"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Approved -> Notify User Login disable for one hour",
            "targetStep": "\/api\/3\/workflow_steps\/4209aa95-0d8e-4f3a-9d60-0cdd0c7da9d1",
            "sourceStep": "\/api\/3\/workflow_steps\/793438dc-536b-431f-9e9c-4d9d95c89725",
            "label": "Approved",
            "isExecuted": false,
            "uuid": "39844442-a9c5-4e90-adf9-22e5069342cf"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Approved -> Add Note for Not Approved",
            "targetStep": "\/api\/3\/workflow_steps\/cd3b063c-66a9-4340-8870-649a13b594ff",
            "sourceStep": "\/api\/3\/workflow_steps\/793438dc-536b-431f-9e9c-4d9d95c89725",
            "label": "Not Approved",
            "isExecuted": false,
            "uuid": "16d8e5d8-df29-4b91-9f9d-8b8e8d2af476"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Note for External IP -> Retrieve Users Details From AD",
            "targetStep": "\/api\/3\/workflow_steps\/38452871-54a9-40d2-aa7e-e39f32c962e4",
            "sourceStep": "\/api\/3\/workflow_steps\/06cd91df-ac56-4b16-bb4c-ce4736590da4",
            "label": null,
            "isExecuted": false,
            "uuid": "09ec3f44-0504-48b4-8558-ce93de2f188c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "convert CEF to json -> Add Note to Alert with searched data",
            "targetStep": "\/api\/3\/workflow_steps\/34e15fce-a62f-4304-a73b-f46fb14ccac2",
            "sourceStep": "\/api\/3\/workflow_steps\/a0162c7f-65ab-4474-9104-f63a78df9f47",
            "label": null,
            "isExecuted": false,
            "uuid": "a82c795f-65fb-4790-a2ef-6a35b05bd67c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for User Details -> searching users 4 hours of login data in fortisiem",
            "targetStep": "\/api\/3\/workflow_steps\/bc7c45df-e702-4195-8ba0-667944584e46",
            "sourceStep": "\/api\/3\/workflow_steps\/72f1dcdf-6cf3-49c0-afe6-460bb3b09fb8",
            "label": null,
            "isExecuted": false,
            "uuid": "2718bee3-175e-40df-a9ef-94652e89971b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "check if Login Attempted in last 10 min -> Check if Login Attempted",
            "targetStep": "\/api\/3\/workflow_steps\/fdd39a5c-c7d2-4b39-95c1-73dc21561e4f",
            "sourceStep": "\/api\/3\/workflow_steps\/20a1c87e-50fe-4e3a-9e9f-1bb824d4dd95",
            "label": null,
            "isExecuted": false,
            "uuid": "300bcfe8-f376-41de-9dc8-acd1c2e5f612"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Login Attempt -> Reset Password",
            "targetStep": "\/api\/3\/workflow_steps\/9b4b232c-6b41-4fbc-b0bc-234ff94b166b",
            "sourceStep": "\/api\/3\/workflow_steps\/ff2e3745-9271-4a7c-9908-aab8229c8b0c",
            "label": null,
            "isExecuted": false,
            "uuid": "22749f5b-4ce4-4723-b141-5a8b4be3126e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add note for login is not attempted -> Reset Password",
            "targetStep": "\/api\/3\/workflow_steps\/9b4b232c-6b41-4fbc-b0bc-234ff94b166b",
            "sourceStep": "\/api\/3\/workflow_steps\/6f86dc38-1d5b-4492-8f3d-2a0314bc61ef",
            "label": null,
            "isExecuted": false,
            "uuid": "cd72d0d5-bb5d-4197-ba25-731a844152cf"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Login Attempted -> Add Note for Login Attempt",
            "targetStep": "\/api\/3\/workflow_steps\/ff2e3745-9271-4a7c-9908-aab8229c8b0c",
            "sourceStep": "\/api\/3\/workflow_steps\/fdd39a5c-c7d2-4b39-95c1-73dc21561e4f",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "04c87b53-b558-4114-aad9-f9c446f24e9d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Login Attempted -> Add note for login is not attempted",
            "targetStep": "\/api\/3\/workflow_steps\/6f86dc38-1d5b-4492-8f3d-2a0314bc61ef",
            "sourceStep": "\/api\/3\/workflow_steps\/fdd39a5c-c7d2-4b39-95c1-73dc21561e4f",
            "label": "No",
            "isExecuted": false,
            "uuid": "cde23d92-b63e-40af-9781-bac02dbdc039"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Wait for 1 hour -> check if Login Attempted in last 10 min",
            "targetStep": "\/api\/3\/workflow_steps\/20a1c87e-50fe-4e3a-9e9f-1bb824d4dd95",
            "sourceStep": "\/api\/3\/workflow_steps\/c22d047c-ec37-4f6f-915d-017644b21db3",
            "label": null,
            "isExecuted": false,
            "uuid": "b2c72061-3fc6-4eac-82ab-3ad02afe6aa5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note to Alert with searched data -> Add Note for Approval",
            "targetStep": "\/api\/3\/workflow_steps\/714b5b75-7429-418b-87f1-e045349cb1ac",
            "sourceStep": "\/api\/3\/workflow_steps\/34e15fce-a62f-4304-a73b-f46fb14ccac2",
            "label": null,
            "isExecuted": false,
            "uuid": "f9d2d5f2-3e44-4aa7-ad3e-2e5669326c2e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Approval -> Send Approval for Login Disable",
            "targetStep": "\/api\/3\/workflow_steps\/946a0e3a-423d-45c8-91f3-53b11b207afd",
            "sourceStep": "\/api\/3\/workflow_steps\/714b5b75-7429-418b-87f1-e045349cb1ac",
            "label": null,
            "isExecuted": false,
            "uuid": "c65c1870-aed4-4130-8903-b38190f475c8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Disable User Login -> Add note for pause",
            "targetStep": "\/api\/3\/workflow_steps\/503ec667-67a0-40ed-9dec-5dc2381b2a1a",
            "sourceStep": "\/api\/3\/workflow_steps\/f31dfa7b-34b9-4d8a-8488-7426863d95ac",
            "label": null,
            "isExecuted": false,
            "uuid": "ee05f0a3-5950-414a-9c79-3f4c2176c49d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add note for pause -> Wait for 1 hour",
            "targetStep": "\/api\/3\/workflow_steps\/c22d047c-ec37-4f6f-915d-017644b21db3",
            "sourceStep": "\/api\/3\/workflow_steps\/503ec667-67a0-40ed-9dec-5dc2381b2a1a",
            "label": null,
            "isExecuted": false,
            "uuid": "9cd34553-2a3a-4432-8f60-c5a07af0113d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Search users 4 hours of login data in fortisiem -> convert CEF to json",
            "targetStep": "\/api\/3\/workflow_steps\/a0162c7f-65ab-4474-9104-f63a78df9f47",
            "sourceStep": "\/api\/3\/workflow_steps\/bc7c45df-e702-4195-8ba0-667944584e46",
            "label": null,
            "isExecuted": false,
            "uuid": "1cca81eb-cc41-4c1d-a70a-29c53f672fba"
        }
    ],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "4719c477-28f5-4d8d-9022-f70fe75ccb3d",
    "recordTags": [
        "ManualAction"
    ],
    "id": 990,
    "createUser": "\/api\/3\/appliances\/57545210-2adc-472b-a24f-2df6ee8dfe63",
    "createDate": 1637679107,
    "modifyUser": "\/api\/3\/appliances\/57545210-2adc-472b-a24f-2df6ee8dfe63",
    "modifyDate": 1637679107,
    "owners": [],
    "isPrivate": false
}