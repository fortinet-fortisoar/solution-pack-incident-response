{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Add to Exclude List",
    "aliasName": null,
    "tag": null,
    "description": "Adds specified indicators as global variables, which excludes them from being considered as IoCs.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1636537406,
    "collection": "\/api\/3\/workflow_collections\/a41c4bc4-5b29-4701-96e7-e62e21e8763e",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/c6a6c7c5-8784-42bd-ae9e-df95f6c24928",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "748818fa-9e22-42c9-badd-218eede46931",
                "title": "",
                "resources": [
                    "indicators"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "records": "{{vars.input.records}}"
                    }
                },
                "displayConditions": {
                    "indicators": {
                        "sort": [],
                        "limit": 30,
                        "logic": "OR",
                        "filters": [
                            {
                                "type": "object",
                                "field": "typeofindicator",
                                "value": "\/api\/3\/picklists\/5a5a7d42-be27-4903-858a-19909ebfa1eb",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/5a5a7d42-be27-4903-858a-19909ebfa1eb",
                                    "itemValue": "Domain"
                                },
                                "operator": "eq"
                            },
                            {
                                "type": "object",
                                "field": "typeofindicator",
                                "value": "\/api\/3\/picklists\/c0beeda4-2c7a-4214-b7e5-53ba1649539c",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/c0beeda4-2c7a-4214-b7e5-53ba1649539c",
                                    "itemValue": "IP Address"
                                },
                                "operator": "eq"
                            },
                            {
                                "type": "object",
                                "field": "typeofindicator",
                                "value": "\/api\/3\/picklists\/353a37b4-3eeb-43ee-aac6-64806422cfec",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/353a37b4-3eeb-43ee-aac6-64806422cfec",
                                    "itemValue": "URL"
                                },
                                "operator": "eq"
                            }
                        ]
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
            },
            "status": null,
            "top": "30",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "uuid": "c6a6c7c5-8784-42bd-ae9e-df95f6c24928",
            "id": 2051
        },
        {
            "@type": "WorkflowStep",
            "name": "Check Type of Indicator",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Domain",
                        "step_iri": "\/api\/3\/workflow_steps\/cd42d7f2-ffba-493b-9e39-347179300497",
                        "condition": "{{ vars.input.records[0].typeofindicator.itemValue == 'Domain' }}",
                        "step_name": "Add Domain to Whitelisted Domains List"
                    },
                    {
                        "option": "URL",
                        "step_iri": "\/api\/3\/workflow_steps\/684df151-82f1-4c6c-a36a-8fe96d881767",
                        "condition": "{{ vars.input.records[0].typeofindicator.itemValue == 'URL' }}",
                        "step_name": "Add URL to Whitelisted URL List"
                    },
                    {
                        "option": "IP",
                        "step_iri": "\/api\/3\/workflow_steps\/c3fbd641-7774-41ed-8759-db97fd66e87e",
                        "condition": "{{ vars.input.records[0].typeofindicator.itemValue == 'IP Address' }}",
                        "step_name": "Add IP to Whitelisted IP List"
                    }
                ]
            },
            "status": null,
            "top": "165",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "3ed07563-5c34-43f1-b0ad-25aca86ccd9a",
            "id": 2052
        },
        {
            "@type": "WorkflowStep",
            "name": "Add IP to Excluded IP List",
            "description": null,
            "arguments": {
                "ips": "{{globalVars.Excludelist_IPs + ',' + vars.input.records[0].value}}"
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "c3fbd641-7774-41ed-8759-db97fd66e87e",
            "id": 2053
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Domain to Excluded Domains List",
            "description": null,
            "arguments": {
                "domains": "{{globalVars.Excludelist_Domains + ',' + vars.input.records[0].value}}"
            },
            "status": null,
            "top": "300",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "cd42d7f2-ffba-493b-9e39-347179300497",
            "id": 2054
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Excluded Urls",
            "description": null,
            "arguments": {
                "params": {
                    "macro": "Excludelist_URLs",
                    "value": "{{vars.urls}}"
                },
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Update Global Variables",
                "step_variables": []
            },
            "status": null,
            "top": "440",
            "left": "827",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "ae9ed97d-b891-4738-b180-1e476c05e992",
            "id": 2055
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Excluded IPs List",
            "description": null,
            "arguments": {
                "params": {
                    "macro": "Excludelist_IPs",
                    "value": "{{vars.ips}}"
                },
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Update Global Variables",
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "90f84c89-a7cb-43fe-a5e2-132387ef2cc8",
            "id": 2056
        },
        {
            "@type": "WorkflowStep",
            "name": "Add URL to Excluded URL List",
            "description": null,
            "arguments": {
                "urls": "{{globalVars.Excludelist_URLs + ',' + vars.input.records[0].value}}"
            },
            "status": null,
            "top": "300",
            "left": "826",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "684df151-82f1-4c6c-a36a-8fe96d881767",
            "id": 2057
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Indicator to Exclude List",
            "description": null,
            "arguments": {
                "resource": {
                    "indicatorStatus": {
                        "id": 368,
                        "@id": "\/api\/3\/picklists\/4218cb58-4de5-4eff-ad08-185d36ef9bab",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Excluded",
                        "listName": "\/api\/3\/picklist_names\/e6639d57-94a9-432f-a46f-b2b530402077",
                        "itemValue": "Excluded",
                        "orderIndex": 2
                    }
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "\/api\/3\/indicators",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "6b89e18a-478c-4457-873f-ad5f0c2c9396",
            "id": 2058
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Excluded Domains List",
            "description": null,
            "arguments": {
                "params": {
                    "macro": "Excludelist_Domains",
                    "value": "{{vars.domains}}"
                },
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Update Global Variables",
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "8bc83533-0f62-4d40-8aed-09b8418710ca",
            "id": 2059
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Add Domain to Whitelisted Domains List -> Update Whitelisted Domains",
            "targetStep": "\/api\/3\/workflow_steps\/8bc83533-0f62-4d40-8aed-09b8418710ca",
            "sourceStep": "\/api\/3\/workflow_steps\/cd42d7f2-ffba-493b-9e39-347179300497",
            "label": null,
            "isExecuted": false,
            "uuid": "333830f0-caea-40c6-a216-953178f33daa"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Whitelisted Domains -> Uodate Indicator as Whitelisted",
            "targetStep": "\/api\/3\/workflow_steps\/6b89e18a-478c-4457-873f-ad5f0c2c9396",
            "sourceStep": "\/api\/3\/workflow_steps\/8bc83533-0f62-4d40-8aed-09b8418710ca",
            "label": null,
            "isExecuted": false,
            "uuid": "c5b0b8f5-6bf9-48f0-8ae9-0578c94b5808"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check Type of Indicator -> Add Domain to Whitelisted Domains List",
            "targetStep": "\/api\/3\/workflow_steps\/cd42d7f2-ffba-493b-9e39-347179300497",
            "sourceStep": "\/api\/3\/workflow_steps\/3ed07563-5c34-43f1-b0ad-25aca86ccd9a",
            "label": "Domain",
            "isExecuted": false,
            "uuid": "a12a0884-6f8b-4182-bfc2-8e61ac30eae8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Check Type of Indicator",
            "targetStep": "\/api\/3\/workflow_steps\/3ed07563-5c34-43f1-b0ad-25aca86ccd9a",
            "sourceStep": "\/api\/3\/workflow_steps\/c6a6c7c5-8784-42bd-ae9e-df95f6c24928",
            "label": null,
            "isExecuted": false,
            "uuid": "b91e0eea-660c-4daa-8544-2bae755a15cd"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Whitelisted Urls -> Uodate Indicator as Whitelisted",
            "targetStep": "\/api\/3\/workflow_steps\/6b89e18a-478c-4457-873f-ad5f0c2c9396",
            "sourceStep": "\/api\/3\/workflow_steps\/ae9ed97d-b891-4738-b180-1e476c05e992",
            "label": null,
            "isExecuted": false,
            "uuid": "33245e3d-dca3-4282-bff6-fc5c164d93df"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check Type of Indicator -> Add IP to Whitelisted IP List",
            "targetStep": "\/api\/3\/workflow_steps\/c3fbd641-7774-41ed-8759-db97fd66e87e",
            "sourceStep": "\/api\/3\/workflow_steps\/3ed07563-5c34-43f1-b0ad-25aca86ccd9a",
            "label": "IP",
            "isExecuted": false,
            "uuid": "77f82837-9816-49f7-8ecd-952fec5199ee"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Whitelisted IPs -> Uodate Indicator as Whitelisted",
            "targetStep": "\/api\/3\/workflow_steps\/6b89e18a-478c-4457-873f-ad5f0c2c9396",
            "sourceStep": "\/api\/3\/workflow_steps\/90f84c89-a7cb-43fe-a5e2-132387ef2cc8",
            "label": null,
            "isExecuted": false,
            "uuid": "1cf88337-6799-4039-ba9b-ed6030d121a5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add IP to Whitelisted IP List -> Update Whitelisted IPs",
            "targetStep": "\/api\/3\/workflow_steps\/90f84c89-a7cb-43fe-a5e2-132387ef2cc8",
            "sourceStep": "\/api\/3\/workflow_steps\/c3fbd641-7774-41ed-8759-db97fd66e87e",
            "label": null,
            "isExecuted": false,
            "uuid": "867d32a6-a2f9-455f-9197-34a9b1a18963"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add URL to Whitelisted URL List -> Update Whitelisted Urls",
            "targetStep": "\/api\/3\/workflow_steps\/ae9ed97d-b891-4738-b180-1e476c05e992",
            "sourceStep": "\/api\/3\/workflow_steps\/684df151-82f1-4c6c-a36a-8fe96d881767",
            "label": null,
            "isExecuted": false,
            "uuid": "3e2a4b45-ec1a-4925-994f-820d7325d0df"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check Type of Indicator -> Add URL to Whitelisted URL List",
            "targetStep": "\/api\/3\/workflow_steps\/684df151-82f1-4c6c-a36a-8fe96d881767",
            "sourceStep": "\/api\/3\/workflow_steps\/3ed07563-5c34-43f1-b0ad-25aca86ccd9a",
            "label": "URL",
            "isExecuted": false,
            "uuid": "cd0d56b5-a3db-43d8-8237-ba590e12ee97"
        }
    ],
    "priority": null,
    "uuid": "0e55333d-fd0e-425c-bd95-2f3a24e1f45c",
    "recordTags": [
        "ManualAction"
    ],
    "id": 292,
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1636537433,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1636537433,
    "owners": [],
    "isPrivate": false
}